Gemma's activation function should be approximate GeLU and not exact GeLU.
Changing the activation function to `gelu_pytorch_tanh`.if you want to use the legacy `gelu`, edit the `model.config` to set `hidden_activation=gelu`   instead of `hidden_act`. See https://github.com/huggingface/transformers/pull/29402 for more details.
OpenAI API key not found, will not be able to run evaluations on Sports Trivia Task
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:01<00:03,  1.07s/it]Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:02<00:02,  1.15s/it]Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:03<00:01,  1.16s/it]Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:03<00:00,  1.10it/s]Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:03<00:00,  1.01it/s]
wandb: Currently logged in as: aaquib111. Use `wandb login --relogin` to force relogin
wandb: Appending key for api.wandb.ai to your netrc file: /root/.netrc
wandb: wandb version 0.17.0 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.6
wandb: Run data is saved locally in /root/mechanistic-unlearning/wandb/run-20240522_040111-floph9sd
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run gemma-7b-athlete-none
wandb: â­ï¸ View project at https://wandb.ai/aaquib111/mech-unlearning
wandb: ðŸš€ View run at https://wandb.ai/aaquib111/mech-unlearning/runs/floph9sd
Loaded pretrained model google/gemma-7b into HookedTransformer
  0%|          | 0/50 [00:00<?, ?it/s]  2%|â–         | 1/50 [00:50<40:55, 50.11s/it]  4%|â–         | 2/50 [01:21<31:26, 39.31s/it]  6%|â–Œ         | 3/50 [01:53<28:00, 35.75s/it]  8%|â–Š         | 4/50 [02:26<26:41, 34.81s/it] 10%|â–ˆ         | 5/50 [03:00<25:41, 34.26s/it] 12%|â–ˆâ–        | 6/50 [03:53<30:00, 40.92s/it] 14%|â–ˆâ–        | 7/50 [04:25<27:11, 37.94s/it] 16%|â–ˆâ–Œ        | 8/50 [04:58<25:31, 36.46s/it] 18%|â–ˆâ–Š        | 9/50 [05:30<23:53, 34.96s/it] 20%|â–ˆâ–ˆ        | 10/50 [06:02<22:36, 33.92s/it] 22%|â–ˆâ–ˆâ–       | 11/50 [06:58<26:34, 40.88s/it] 24%|â–ˆâ–ˆâ–       | 12/50 [07:32<24:33, 38.78s/it] 26%|â–ˆâ–ˆâ–Œ       | 13/50 [08:06<22:58, 37.24s/it] 28%|â–ˆâ–ˆâ–Š       | 14/50 [08:40<21:43, 36.20s/it] 30%|â–ˆâ–ˆâ–ˆ       | 15/50 [09:14<20:40, 35.46s/it] 32%|â–ˆâ–ˆâ–ˆâ–      | 16/50 [10:10<23:35, 41.63s/it] 34%|â–ˆâ–ˆâ–ˆâ–      | 17/50 [10:45<21:51, 39.75s/it] 36%|â–ˆâ–ˆâ–ˆâ–Œ      | 18/50 [11:18<20:10, 37.83s/it] 38%|â–ˆâ–ˆâ–ˆâ–Š      | 19/50 [11:54<19:09, 37.10s/it] 40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 20/50 [12:27<18:00, 36.03s/it] 42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 21/50 [13:23<20:18, 42.00s/it] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 22/50 [13:58<18:37, 39.91s/it] 46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 23/50 [14:34<17:20, 38.54s/it] 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 24/50 [15:07<16:03, 37.06s/it] 50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 25/50 [15:41<15:01, 36.05s/it] 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 26/50 [16:36<16:42, 41.78s/it] 54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 27/50 [17:12<15:21, 40.09s/it] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 28/50 [17:47<14:04, 38.39s/it] 58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 29/50 [18:20<12:55, 36.94s/it] 60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 30/50 [18:55<12:08, 36.40s/it] 62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 31/50 [19:51<13:20, 42.12s/it] 64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 32/50 [20:24<11:51, 39.52s/it] 66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 33/50 [20:58<10:42, 37.79s/it] 68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 34/50 [21:34<09:55, 37.22s/it] 70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 35/50 [22:07<09:00, 36.05s/it] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 36/50 [23:03<09:47, 41.99s/it] 74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 37/50 [23:38<08:39, 39.97s/it] 76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 38/50 [24:12<07:36, 38.07s/it] 78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 39/50 [24:46<06:46, 36.95s/it] 80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 40/50 [25:20<06:00, 36.04s/it] 82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 41/50 [26:17<06:19, 42.20s/it] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 42/50 [26:50<05:17, 39.65s/it] 86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 43/50 [27:24<04:25, 37.95s/it] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 44/50 [27:58<03:39, 36.61s/it] 90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 45/50 [28:31<02:58, 35.66s/it] 92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 46/50 [29:27<02:46, 41.53s/it] 94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 47/50 [30:02<01:58, 39.62s/it] 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 48/50 [30:35<01:15, 37.77s/it] 98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 49/50 [31:09<00:36, 36.57s/it]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 50/50 [32:06<00:00, 42.83s/it]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 50/50 [32:06<00:00, 38.54s/it]
wandb: - 0.040 MB of 0.040 MB uploadedwandb: \ 0.040 MB of 0.050 MB uploadedwandb: | 0.040 MB of 0.050 MB uploadedwandb: / 0.050 MB of 0.050 MB uploadedwandb:                                                                                
wandb: 
wandb: Run history:
wandb:     test_loss_forget_sport â–â–â–â–â–‚â–‚â–‚â–‚â–ƒâ–ƒâ–ƒâ–ƒâ–ƒâ–ƒâ–ƒâ–ƒâ–ƒâ–ƒâ–ƒâ–ƒâ–…â–…â–…â–…â–„â–„â–„â–„â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–‡â–ˆâ–ˆâ–ˆâ–ˆ
wandb:        test_loss_induction â–‚â–‚â–‚â–‚â–…â–…â–…â–…â–…â–…â–…â–…â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–…â–…â–…â–…â–„â–„â–„â–„â–†â–†â–†â–†â–â–â–â–â–ˆâ–ˆâ–ˆâ–‚
wandb:   test_loss_maintain_sport â–â–â–â–â–ˆâ–ˆâ–ˆâ–ˆâ–‚â–‚â–‚â–‚â–â–â–â–â–ƒâ–ƒâ–ƒâ–ƒâ–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–â–â–â–â–â–â–â–â–„â–„â–„â–
wandb:             test_loss_pile â–†â–†â–†â–†â–†â–†â–†â–†â–†â–†â–†â–†â–â–â–â–â–ˆâ–ˆâ–ˆâ–ˆâ–„â–„â–„â–„â–…â–…â–…â–…â–„â–„â–„â–„â–…â–…â–…â–…â–‡â–‡â–‡â–
wandb: train_loss_maintain_sports â–â–‚â–ˆâ–„â–‚â–‚â–‚â–‚â–‚â–…â–‚â–„â–‚â–â–‚â–‚â–‚â–‚â–â–‚â–ƒâ–‚â–â–â–‚â–‚â–‚â–‚â–‚â–â–â–â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–
wandb:            train_loss_pile â–„â–…â–„â–â–†â–ƒâ–†â–†â–ˆâ–…â–ƒâ–ƒâ–‚â–„â–†â–†â–ƒâ–†â–…â–„â–„â–†â–‡â–ƒâ–†â–…â–…â–‡â–‡â–„â–„â–„â–„â–ƒâ–ˆâ–„â–…â–ƒâ–„â–ƒ
wandb:             train_loss_reg â–ˆâ–†â–†â–†â–†â–†â–†â–†â–†â–ƒâ–ƒâ–ƒâ–ƒâ–ƒâ–ƒâ–ƒâ–ƒâ–ƒâ–ƒâ–ƒâ–ƒâ–ƒâ–ƒâ–ƒâ–ƒâ–ƒâ–ƒâ–ƒâ–â–â–â–â–â–â–â–â–â–â–â–
wandb:      train_loss_sports_1mp â–ˆâ–‡â–‚â–ƒâ–„â–…â–„â–„â–ƒâ–„â–…â–ƒâ–ƒâ–„â–„â–‚â–ƒâ–…â–„â–‚â–‚â–‚â–„â–…â–‚â–‚â–‚â–â–â–‚â–‚â–‚â–â–â–â–‚â–‚â–â–â–
wandb: 
wandb: Run summary:
wandb:     test_loss_forget_sport 1.15668
wandb:        test_loss_induction 0.54801
wandb:   test_loss_maintain_sport 0.1154
wandb:             test_loss_pile 2.28619
wandb: train_loss_maintain_sports 0.14899
wandb:            train_loss_pile 2.19586
wandb:             train_loss_reg 1.61045
wandb:      train_loss_sports_1mp 0.47271
wandb: 
wandb: ðŸš€ View run gemma-7b-athlete-none at: https://wandb.ai/aaquib111/mech-unlearning/runs/floph9sd
wandb: â­ï¸ View project at: https://wandb.ai/aaquib111/mech-unlearning
wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240522_040111-floph9sd/logs
Running sports_1mp
Running maintain_sports
Running pile
reg loss, 1.610448956489563
Running adversarial evals
Running sports_1mp
Running maintain_sports
Running pile
reg loss, 1.6104488372802734
Running sports_1mp
Running maintain_sports
Running pile
reg loss, 1.6104488372802734
Running sports_1mp
Running maintain_sports
Running pile
reg loss, 1.6104488372802734
Running sports_1mp
Running maintain_sports
Running pile
reg loss, 1.6104488372802734
Running sports_1mp
Running maintain_sports
Running pile
reg loss, 1.6104488372802734
Running adversarial evals
Running sports_1mp
Running maintain_sports
Running pile
reg loss, 1.6104488372802734
Running sports_1mp
Running maintain_sports
Running pile
reg loss, 1.6104488372802734
Running sports_1mp
Running maintain_sports
Running pile
reg loss, 1.6104488372802734
Running sports_1mp
Running maintain_sports
Running pile
reg loss, 1.6104488372802734
Running sports_1mp
Running maintain_sports
Running pile
reg loss, 1.6104488372802734
Running adversarial evals
Running sports_1mp
Running maintain_sports
Running pile
reg loss, 1.6104487180709839
Running sports_1mp
Running maintain_sports
Running pile
reg loss, 1.6104487180709839
Running sports_1mp
Running maintain_sports
Running pile
reg loss, 1.6104487180709839
Running sports_1mp
Running maintain_sports
Running pile
reg loss, 1.6104487180709839
Running sports_1mp
Running maintain_sports
Running pile
reg loss, 1.6104487180709839
Running adversarial evals
Running sports_1mp
Running maintain_sports
Running pile
reg loss, 1.6104487180709839
Running sports_1mp
Running maintain_sports
Running pile
reg loss, 1.6104487180709839
Running sports_1mp
Running maintain_sports
Running pile
reg loss, 1.6104487180709839
Running sports_1mp
Running maintain_sports
Running pile
reg loss, 1.6104487180709839
Running sports_1mp
Running maintain_sports
Running pile
reg loss, 1.6104487180709839
Running adversarial evals
Running sports_1mp
Running maintain_sports
Running pile
reg loss, 1.6104487180709839
Running sports_1mp
Running maintain_sports
Running pile
reg loss, 1.6104487180709839
Running sports_1mp
Running maintain_sports
Running pile
reg loss, 1.6104487180709839
Running sports_1mp
Running maintain_sports
Running pile
reg loss, 1.6104487180709839
Running sports_1mp
Running maintain_sports
Running pile
reg loss, 1.6104487180709839
Running adversarial evals
Running sports_1mp
Running maintain_sports
Running pile
reg loss, 1.6104487180709839
Running sports_1mp
Running maintain_sports
Running pile
reg loss, 1.6104487180709839
Running sports_1mp
Running maintain_sports
Running pile
reg loss, 1.6104487180709839
Running sports_1mp
Running maintain_sports
Running pile
reg loss, 1.6104487180709839
Running sports_1mp
Running maintain_sports
Running pile
reg loss, 1.6104487180709839
Running adversarial evals
Running sports_1mp
Running maintain_sports
Running pile
reg loss, 1.6104487180709839
Running sports_1mp
Running maintain_sports
Running pile
reg loss, 1.6104487180709839
Running sports_1mp
Running maintain_sports
Running pile
reg loss, 1.6104487180709839
Running sports_1mp
Running maintain_sports
Running pile
reg loss, 1.6104487180709839
Running sports_1mp
Running maintain_sports
Running pile
reg loss, 1.6104485988616943
Running adversarial evals
Running sports_1mp
Running maintain_sports
Running pile
reg loss, 1.6104485988616943
Running sports_1mp
Running maintain_sports
Running pile
reg loss, 1.6104485988616943
Running sports_1mp
Running maintain_sports
Running pile
reg loss, 1.6104485988616943
Running sports_1mp
Running maintain_sports
Running pile
reg loss, 1.6104485988616943
Running sports_1mp
Running maintain_sports
Running pile
reg loss, 1.6104485988616943
Running adversarial evals
Running sports_1mp
Running maintain_sports
Running pile
reg loss, 1.6104485988616943
Running sports_1mp
Running maintain_sports
Running pile
reg loss, 1.6104485988616943
Running sports_1mp
Running maintain_sports
Running pile
reg loss, 1.6104485988616943
Running sports_1mp
Running maintain_sports
Running pile
reg loss, 1.6104485988616943
Running sports_1mp
Running maintain_sports
Running pile
reg loss, 1.6104485988616943
Running adversarial evals
Running sports_1mp
Running maintain_sports
Running pile
reg loss, 1.6104485988616943
Running sports_1mp
Running maintain_sports
Running pile
reg loss, 1.6104485988616943
Running sports_1mp
Running maintain_sports
Running pile
reg loss, 1.6104485988616943
Running sports_1mp
Running maintain_sports
Running pile
reg loss, 1.6104485988616943
Running adversarial evals
