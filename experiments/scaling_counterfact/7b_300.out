`config.hidden_act` is ignored, you should use `config.hidden_activation` instead.
Gemma's activation function will be set to `gelu_pytorch_tanh`. Please, use
`config.hidden_activation` if you want to override this behaviour.
See https://github.com/huggingface/transformers/pull/29402 for more details.
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Loading checkpoint shards:  25%|██▌       | 1/4 [00:02<00:07,  2.47s/it]Loading checkpoint shards:  50%|█████     | 2/4 [00:04<00:04,  2.46s/it]Loading checkpoint shards:  75%|███████▌  | 3/4 [00:07<00:02,  2.51s/it]Loading checkpoint shards: 100%|██████████| 4/4 [00:08<00:00,  2.03s/it]Loading checkpoint shards: 100%|██████████| 4/4 [00:08<00:00,  2.20s/it]
WARNING:root:You are not using LayerNorm, so the writing weights can't be centered! Skipping
wandb: Currently logged in as: aaquib111. Use `wandb login --relogin` to force relogin
wandb: wandb version 0.19.8 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.6
wandb: Run data is saved locally in /root/mechanistic-unlearning/experiments/scaling_counterfact/wandb/run-20250330_204151-rm7yet77
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run cfact_scale_google_gemma-7b_300facts
wandb: ⭐️ View project at https://wandb.ai/aaquib111/mech-unlearning
wandb: 🚀 View run at https://wandb.ai/aaquib111/mech-unlearning/runs/rm7yet77
Loaded pretrained model google/gemma-7b into HookedTransformer
  0%|          | 0/154 [00:00<?, ?it/s]  0%|          | 0/154 [00:14<?, ?it/s, edit_acc=0, forget_acc=1, inject_loss=7.88, retain_loss=6.17, sft_loss=9.62]  0%|          | 0/154 [00:24<?, ?it/s, edit_acc=0, forget_acc=1, inject_loss=8.01, retain_loss=3.3, sft_loss=9.75]   1%|          | 1/154 [00:25<1:05:22, 25.64s/it, edit_acc=0, forget_acc=1, inject_loss=8.01, retain_loss=3.3, sft_loss=9.75]  1%|          | 1/154 [00:36<1:05:22, 25.64s/it, edit_acc=0, forget_acc=1, inject_loss=8.46, retain_loss=3.71, sft_loss=2.15]  1%|          | 1/154 [00:49<1:05:22, 25.64s/it, edit_acc=0, forget_acc=1, inject_loss=11, retain_loss=4.37, sft_loss=6.01]    1%|          | 1/154 [01:00<1:05:22, 25.64s/it, edit_acc=0, forget_acc=1, inject_loss=15.4, retain_loss=3.21, sft_loss=6.18]  1%|▏         | 2/154 [01:01<1:19:46, 31.49s/it, edit_acc=0, forget_acc=1, inject_loss=15.4, retain_loss=3.21, sft_loss=6.18]  1%|▏         | 2/154 [01:09<1:19:46, 31.49s/it, edit_acc=0, forget_acc=1, inject_loss=12.8, retain_loss=3.45, sft_loss=9.34]  2%|▏         | 3/154 [01:10<54:12, 21.54s/it, edit_acc=0, forget_acc=1, inject_loss=12.8, retain_loss=3.45, sft_loss=9.34]    2%|▏         | 3/154 [01:20<54:12, 21.54s/it, edit_acc=0, forget_acc=1, inject_loss=10.7, retain_loss=5.22, sft_loss=5.54]  3%|▎         | 4/154 [01:21<43:08, 17.26s/it, edit_acc=0, forget_acc=1, inject_loss=10.7, retain_loss=5.22, sft_loss=5.54]  3%|▎         | 4/154 [01:30<43:08, 17.26s/it, edit_acc=0, forget_acc=1, inject_loss=4.2, retain_loss=3.48, sft_loss=2.39]   3%|▎         | 5/154 [01:31<36:35, 14.74s/it, edit_acc=0, forget_acc=1, inject_loss=4.2, retain_loss=3.48, sft_loss=2.39]  3%|▎         | 5/154 [01:40<36:35, 14.74s/it, edit_acc=0, forget_acc=1, inject_loss=10.9, retain_loss=5.56, sft_loss=9.39]  4%|▍         | 6/154 [01:41<32:20, 13.11s/it, edit_acc=0, forget_acc=1, inject_loss=10.9, retain_loss=5.56, sft_loss=9.39]  4%|▍         | 6/154 [01:50<32:20, 13.11s/it, edit_acc=0, forget_acc=1, inject_loss=6.46, retain_loss=2.6, sft_loss=6.26]   5%|▍         | 7/154 [01:51<29:41, 12.12s/it, edit_acc=0, forget_acc=1, inject_loss=6.46, retain_loss=2.6, sft_loss=6.26]  5%|▍         | 7/154 [02:01<29:41, 12.12s/it, edit_acc=0, forget_acc=1, inject_loss=8.36, retain_loss=3.28, sft_loss=2.26]  5%|▌         | 8/154 [02:02<28:24, 11.68s/it, edit_acc=0, forget_acc=1, inject_loss=8.36, retain_loss=3.28, sft_loss=2.26]  5%|▌         | 8/154 [02:11<28:24, 11.68s/it, edit_acc=0, forget_acc=1, inject_loss=8.81, retain_loss=2.32, sft_loss=2.65]  6%|▌         | 9/154 [02:13<27:19, 11.30s/it, edit_acc=0, forget_acc=1, inject_loss=8.81, retain_loss=2.32, sft_loss=2.65]  6%|▌         | 9/154 [02:22<27:19, 11.30s/it, edit_acc=0, forget_acc=1, inject_loss=10.2, retain_loss=5.3, sft_loss=8.84]   6%|▋         | 10/154 [02:23<26:45, 11.15s/it, edit_acc=0, forget_acc=1, inject_loss=10.2, retain_loss=5.3, sft_loss=8.84]  6%|▋         | 10/154 [02:33<26:45, 11.15s/it, edit_acc=0, forget_acc=1, inject_loss=8.57, retain_loss=2.54, sft_loss=2.44]  7%|▋         | 11/154 [02:34<26:01, 10.92s/it, edit_acc=0, forget_acc=1, inject_loss=8.57, retain_loss=2.54, sft_loss=2.44]  7%|▋         | 11/154 [02:40<26:01, 10.92s/it, edit_acc=0, forget_acc=1, inject_loss=8.21, retain_loss=3.34, sft_loss=5.85]  8%|▊         | 12/154 [02:42<23:33,  9.95s/it, edit_acc=0, forget_acc=1, inject_loss=8.21, retain_loss=3.34, sft_loss=5.85]  8%|▊         | 12/154 [02:50<23:33,  9.95s/it, edit_acc=1, forget_acc=0, inject_loss=9.08, retain_loss=3.93, sft_loss=2.44]  8%|▊         | 13/154 [02:52<23:24,  9.96s/it, edit_acc=1, forget_acc=0, inject_loss=9.08, retain_loss=3.93, sft_loss=2.44]  8%|▊         | 13/154 [03:02<23:24,  9.96s/it, edit_acc=0, forget_acc=1, inject_loss=8.18, retain_loss=3.2, sft_loss=6.14]   8%|▊         | 13/154 [03:12<23:24,  9.96s/it, edit_acc=0, forget_acc=1, inject_loss=8.35, retain_loss=2.93, sft_loss=5.58]  9%|▉         | 14/154 [03:13<31:19, 13.42s/it, edit_acc=0, forget_acc=1, inject_loss=8.35, retain_loss=2.93, sft_loss=5.58]  9%|▉         | 14/154 [03:23<31:19, 13.42s/it, edit_acc=0, forget_acc=1, inject_loss=7.4, retain_loss=3.36, sft_loss=5.88]   9%|▉         | 14/154 [03:33<31:19, 13.42s/it, edit_acc=0, forget_acc=1, inject_loss=9.57, retain_loss=3.14, sft_loss=5.98] 10%|▉         | 15/154 [03:34<36:39, 15.82s/it, edit_acc=0, forget_acc=1, inject_loss=9.57, retain_loss=3.14, sft_loss=5.98] 10%|▉         | 15/154 [03:44<36:39, 15.82s/it, edit_acc=0, forget_acc=1, inject_loss=6.5, retain_loss=4.37, sft_loss=5.39]  10%|█         | 16/154 [03:45<32:35, 14.17s/it, edit_acc=0, forget_acc=1, inject_loss=6.5, retain_loss=4.37, sft_loss=5.39] 10%|█         | 16/154 [03:54<32:35, 14.17s/it, edit_acc=0, forget_acc=1, inject_loss=10.9, retain_loss=2.66, sft_loss=2.48] 11%|█         | 17/154 [03:55<29:42, 13.01s/it, edit_acc=0, forget_acc=1, inject_loss=10.9, retain_loss=2.66, sft_loss=2.48] 11%|█         | 17/154 [04:07<29:42, 13.01s/it, edit_acc=0, forget_acc=1, inject_loss=8.41, retain_loss=3.72, sft_loss=8.51] 12%|█▏        | 18/154 [04:09<29:56, 13.21s/it, edit_acc=0, forget_acc=1, inject_loss=8.41, retain_loss=3.72, sft_loss=8.51] 12%|█▏        | 18/154 [04:18<29:56, 13.21s/it, edit_acc=0, forget_acc=1, inject_loss=10.9, retain_loss=3.11, sft_loss=2.8]  12%|█▏        | 19/154 [04:19<27:35, 12.26s/it, edit_acc=0, forget_acc=1, inject_loss=10.9, retain_loss=3.11, sft_loss=2.8] 12%|█▏        | 19/154 [04:28<27:35, 12.26s/it, edit_acc=0, forget_acc=1, inject_loss=10.6, retain_loss=2.62, sft_loss=2.25] 13%|█▎        | 20/154 [04:29<25:53, 11.59s/it, edit_acc=0, forget_acc=1, inject_loss=10.6, retain_loss=2.62, sft_loss=2.25] 13%|█▎        | 20/154 [04:38<25:53, 11.59s/it, edit_acc=0, forget_acc=1, inject_loss=6.02, retain_loss=3.49, sft_loss=5.36] 14%|█▎        | 21/154 [04:39<24:43, 11.16s/it, edit_acc=0, forget_acc=1, inject_loss=6.02, retain_loss=3.49, sft_loss=5.36] 14%|█▎        | 21/154 [04:47<24:43, 11.16s/it, edit_acc=0, forget_acc=1, inject_loss=7.32, retain_loss=2.3, sft_loss=5.89]  14%|█▍        | 22/154 [04:48<23:29, 10.68s/it, edit_acc=0, forget_acc=1, inject_loss=7.32, retain_loss=2.3, sft_loss=5.89] 14%|█▍        | 22/154 [04:58<23:29, 10.68s/it, edit_acc=1, forget_acc=0, inject_loss=4.91, retain_loss=3.77, sft_loss=6.11] 15%|█▍        | 23/154 [04:59<23:21, 10.70s/it, edit_acc=1, forget_acc=0, inject_loss=4.91, retain_loss=3.77, sft_loss=6.11] 15%|█▍        | 23/154 [05:08<23:21, 10.70s/it, edit_acc=1, forget_acc=0, inject_loss=4.99, retain_loss=3.89, sft_loss=2.45] 16%|█▌        | 24/154 [05:10<22:59, 10.61s/it, edit_acc=1, forget_acc=0, inject_loss=4.99, retain_loss=3.89, sft_loss=2.45] 16%|█▌        | 24/154 [05:18<22:59, 10.61s/it, edit_acc=0, forget_acc=1, inject_loss=8.09, retain_loss=2.29, sft_loss=2.33] 16%|█▌        | 25/154 [05:20<22:22, 10.40s/it, edit_acc=0, forget_acc=1, inject_loss=8.09, retain_loss=2.29, sft_loss=2.33] 16%|█▌        | 25/154 [05:30<22:22, 10.40s/it, edit_acc=0, forget_acc=1, inject_loss=8.9, retain_loss=3.93, sft_loss=2.54]  16%|█▌        | 25/154 [05:41<22:22, 10.40s/it, edit_acc=0.125, forget_acc=0.875, inject_loss=7.74, retain_loss=2.76, sft_loss=5.89] 16%|█▌        | 25/154 [05:51<22:22, 10.40s/it, edit_acc=0, forget_acc=1, inject_loss=8.21, retain_loss=1.71, sft_loss=1.91]         17%|█▋        | 26/154 [05:52<36:15, 16.99s/it, edit_acc=0, forget_acc=1, inject_loss=8.21, retain_loss=1.71, sft_loss=1.91] 17%|█▋        | 26/154 [06:01<36:15, 16.99s/it, edit_acc=0, forget_acc=1, inject_loss=3.4, retain_loss=2.28, sft_loss=6.54]  18%|█▊        | 27/154 [06:02<31:39, 14.96s/it, edit_acc=0, forget_acc=1, inject_loss=3.4, retain_loss=2.28, sft_loss=6.54] 18%|█▊        | 27/154 [06:11<31:39, 14.96s/it, edit_acc=0, forget_acc=1, inject_loss=5.3, retain_loss=2.79, sft_loss=5.85] 18%|█▊        | 28/154 [06:12<28:21, 13.50s/it, edit_acc=0, forget_acc=1, inject_loss=5.3, retain_loss=2.79, sft_loss=5.85] 18%|█▊        | 28/154 [06:21<28:21, 13.50s/it, edit_acc=1, forget_acc=0, inject_loss=3.4, retain_loss=3.31, sft_loss=5.57] 19%|█▉        | 29/154 [06:23<26:30, 12.72s/it, edit_acc=1, forget_acc=0, inject_loss=3.4, retain_loss=3.31, sft_loss=5.57] 19%|█▉        | 29/154 [06:34<26:30, 12.72s/it, edit_acc=0, forget_acc=1, inject_loss=8.37, retain_loss=2.58, sft_loss=9.36] 19%|█▉        | 30/154 [06:35<25:50, 12.50s/it, edit_acc=0, forget_acc=1, inject_loss=8.37, retain_loss=2.58, sft_loss=9.36] 19%|█▉        | 30/154 [06:47<25:50, 12.50s/it, edit_acc=0, forget_acc=1, inject_loss=8, retain_loss=2.17, sft_loss=9.53]    20%|██        | 31/154 [06:48<26:10, 12.77s/it, edit_acc=0, forget_acc=1, inject_loss=8, retain_loss=2.17, sft_loss=9.53] 20%|██        | 31/154 [06:58<26:10, 12.77s/it, edit_acc=0, forget_acc=1, inject_loss=7.38, retain_loss=3.32, sft_loss=2.32] 21%|██        | 32/154 [06:59<24:36, 12.10s/it, edit_acc=0, forget_acc=1, inject_loss=7.38, retain_loss=3.32, sft_loss=2.32] 21%|██        | 32/154 [07:08<24:36, 12.10s/it, edit_acc=0, forget_acc=1, inject_loss=5.88, retain_loss=3.5, sft_loss=5.6]   21%|██▏       | 33/154 [07:10<23:27, 11.63s/it, edit_acc=0, forget_acc=1, inject_loss=5.88, retain_loss=3.5, sft_loss=5.6] 21%|██▏       | 33/154 [07:18<23:27, 11.63s/it, edit_acc=0, forget_acc=1, inject_loss=7.3, retain_loss=2.28, sft_loss=6.07] 22%|██▏       | 34/154 [07:20<22:21, 11.18s/it, edit_acc=0, forget_acc=1, inject_loss=7.3, retain_loss=2.28, sft_loss=6.07] 22%|██▏       | 34/154 [07:29<22:21, 11.18s/it, edit_acc=0, forget_acc=1, inject_loss=6.88, retain_loss=2.86, sft_loss=8.64] 23%|██▎       | 35/154 [07:30<21:28, 10.83s/it, edit_acc=0, forget_acc=1, inject_loss=6.88, retain_loss=2.86, sft_loss=8.64] 23%|██▎       | 35/154 [07:39<21:28, 10.83s/it, edit_acc=0.333, forget_acc=0.667, inject_loss=5.34, retain_loss=3.3, sft_loss=2.56] 23%|██▎       | 36/154 [07:40<20:57, 10.65s/it, edit_acc=0.333, forget_acc=0.667, inject_loss=5.34, retain_loss=3.3, sft_loss=2.56] 23%|██▎       | 36/154 [07:49<20:57, 10.65s/it, edit_acc=0, forget_acc=1, inject_loss=5.03, retain_loss=4.16, sft_loss=5.73]        24%|██▍       | 37/154 [07:50<20:35, 10.56s/it, edit_acc=0, forget_acc=1, inject_loss=5.03, retain_loss=4.16, sft_loss=5.73] 24%|██▍       | 37/154 [07:59<20:35, 10.56s/it, edit_acc=0, forget_acc=1, inject_loss=6.29, retain_loss=3.19, sft_loss=5.72] 25%|██▍       | 38/154 [08:00<19:44, 10.21s/it, edit_acc=0, forget_acc=1, inject_loss=6.29, retain_loss=3.19, sft_loss=5.72] 25%|██▍       | 38/154 [08:08<19:44, 10.21s/it, edit_acc=0, forget_acc=1, inject_loss=7.28, retain_loss=3.58, sft_loss=5.94] 25%|██▌       | 39/154 [08:09<19:13, 10.03s/it, edit_acc=0, forget_acc=1, inject_loss=7.28, retain_loss=3.58, sft_loss=5.94] 25%|██▌       | 39/154 [08:18<19:13, 10.03s/it, edit_acc=0.333, forget_acc=0.667, inject_loss=4.01, retain_loss=3.47, sft_loss=2.4] 26%|██▌       | 40/154 [08:20<19:14, 10.13s/it, edit_acc=0.333, forget_acc=0.667, inject_loss=4.01, retain_loss=3.47, sft_loss=2.4] 26%|██▌       | 40/154 [08:28<19:14, 10.13s/it, edit_acc=0, forget_acc=1, inject_loss=12.5, retain_loss=2.57, sft_loss=12.5]        27%|██▋       | 41/154 [08:30<18:59, 10.08s/it, edit_acc=0, forget_acc=1, inject_loss=12.5, retain_loss=2.57, sft_loss=12.5] 27%|██▋       | 41/154 [08:39<18:59, 10.08s/it, edit_acc=0.333, forget_acc=0.667, inject_loss=6.05, retain_loss=4.97, sft_loss=16.4] 27%|██▋       | 42/154 [08:40<19:03, 10.21s/it, edit_acc=0.333, forget_acc=0.667, inject_loss=6.05, retain_loss=4.97, sft_loss=16.4] 27%|██▋       | 42/154 [08:49<19:03, 10.21s/it, edit_acc=0, forget_acc=1, inject_loss=7.49, retain_loss=3.23, sft_loss=12.9]         28%|██▊       | 43/154 [08:51<18:59, 10.26s/it, edit_acc=0, forget_acc=1, inject_loss=7.49, retain_loss=3.23, sft_loss=12.9] 28%|██▊       | 43/154 [08:59<18:59, 10.26s/it, edit_acc=0, forget_acc=1, inject_loss=8.53, retain_loss=2.14, sft_loss=9.05] 29%|██▊       | 44/154 [09:00<18:32, 10.11s/it, edit_acc=0, forget_acc=1, inject_loss=8.53, retain_loss=2.14, sft_loss=9.05] 29%|██▊       | 44/154 [09:09<18:32, 10.11s/it, edit_acc=0, forget_acc=1, inject_loss=13.1, retain_loss=4.5, sft_loss=5.52]  29%|██▉       | 45/154 [09:10<18:17, 10.07s/it, edit_acc=0, forget_acc=1, inject_loss=13.1, retain_loss=4.5, sft_loss=5.52] 29%|██▉       | 45/154 [09:19<18:17, 10.07s/it, edit_acc=0, forget_acc=1, inject_loss=3.44, retain_loss=2.8, sft_loss=5.59] 30%|██▉       | 46/154 [09:20<17:59,  9.99s/it, edit_acc=0, forget_acc=1, inject_loss=3.44, retain_loss=2.8, sft_loss=5.59] 30%|██▉       | 46/154 [09:28<17:59,  9.99s/it, edit_acc=0, forget_acc=1, inject_loss=3.23, retain_loss=2.22, sft_loss=4.99] 31%|███       | 47/154 [09:30<17:35,  9.86s/it, edit_acc=0, forget_acc=1, inject_loss=3.23, retain_loss=2.22, sft_loss=4.99] 31%|███       | 47/154 [09:38<17:35,  9.86s/it, edit_acc=0, forget_acc=1, inject_loss=6.4, retain_loss=4.16, sft_loss=5.37]  31%|███       | 48/154 [09:39<17:20,  9.82s/it, edit_acc=0, forget_acc=1, inject_loss=6.4, retain_loss=4.16, sft_loss=5.37] 31%|███       | 48/154 [09:49<17:20,  9.82s/it, edit_acc=0, forget_acc=1, inject_loss=13.1, retain_loss=3.03, sft_loss=5.41] 32%|███▏      | 49/154 [09:50<17:26,  9.97s/it, edit_acc=0, forget_acc=1, inject_loss=13.1, retain_loss=3.03, sft_loss=5.41] 32%|███▏      | 49/154 [09:59<17:26,  9.97s/it, edit_acc=0, forget_acc=1, inject_loss=7.94, retain_loss=3, sft_loss=2.28]    32%|███▏      | 50/154 [10:00<17:38, 10.18s/it, edit_acc=0, forget_acc=1, inject_loss=7.94, retain_loss=3, sft_loss=2.28] 32%|███▏      | 50/154 [10:10<17:38, 10.18s/it, edit_acc=0, forget_acc=1, inject_loss=7.85, retain_loss=2.93, sft_loss=2.19] 33%|███▎      | 51/154 [10:11<17:38, 10.28s/it, edit_acc=0, forget_acc=1, inject_loss=7.85, retain_loss=2.93, sft_loss=2.19] 33%|███▎      | 51/154 [10:20<17:38, 10.28s/it, edit_acc=0, forget_acc=1, inject_loss=9.13, retain_loss=2.73, sft_loss=5.83] 34%|███▍      | 52/154 [10:22<17:40, 10.39s/it, edit_acc=0, forget_acc=1, inject_loss=9.13, retain_loss=2.73, sft_loss=5.83] 34%|███▍      | 52/154 [10:30<17:40, 10.39s/it, edit_acc=0.333, forget_acc=0.667, inject_loss=5.78, retain_loss=3.45, sft_loss=4.49] 34%|███▍      | 53/154 [10:32<17:19, 10.29s/it, edit_acc=0.333, forget_acc=0.667, inject_loss=5.78, retain_loss=3.45, sft_loss=4.49] 34%|███▍      | 53/154 [10:41<17:19, 10.29s/it, edit_acc=1, forget_acc=0, inject_loss=2.18, retain_loss=4.34, sft_loss=7.84]         35%|███▌      | 54/154 [10:42<17:11, 10.31s/it, edit_acc=1, forget_acc=0, inject_loss=2.18, retain_loss=4.34, sft_loss=7.84] 35%|███▌      | 54/154 [10:51<17:11, 10.31s/it, edit_acc=0, forget_acc=1, inject_loss=6.95, retain_loss=2.28, sft_loss=5.55] 36%|███▌      | 55/154 [10:52<16:47, 10.17s/it, edit_acc=0, forget_acc=1, inject_loss=6.95, retain_loss=2.28, sft_loss=5.55] 36%|███▌      | 55/154 [11:01<16:47, 10.17s/it, edit_acc=0.25, forget_acc=0.75, inject_loss=4.13, retain_loss=4.16, sft_loss=2.57] 36%|███▋      | 56/154 [11:02<16:43, 10.24s/it, edit_acc=0.25, forget_acc=0.75, inject_loss=4.13, retain_loss=4.16, sft_loss=2.57] 36%|███▋      | 56/154 [11:13<16:43, 10.24s/it, edit_acc=0, forget_acc=1, inject_loss=7.5, retain_loss=3.15, sft_loss=8.3]         37%|███▋      | 57/154 [11:14<17:10, 10.63s/it, edit_acc=0, forget_acc=1, inject_loss=7.5, retain_loss=3.15, sft_loss=8.3] 37%|███▋      | 57/154 [11:22<17:10, 10.63s/it, edit_acc=0, forget_acc=1, inject_loss=8.4, retain_loss=4.26, sft_loss=2.61] 38%|███▊      | 58/154 [11:24<16:38, 10.40s/it, edit_acc=0, forget_acc=1, inject_loss=8.4, retain_loss=4.26, sft_loss=2.61] 38%|███▊      | 58/154 [11:33<16:38, 10.40s/it, edit_acc=0, forget_acc=1, inject_loss=10.1, retain_loss=2.08, sft_loss=8.13] 38%|███▊      | 59/154 [11:34<16:36, 10.49s/it, edit_acc=0, forget_acc=1, inject_loss=10.1, retain_loss=2.08, sft_loss=8.13] 38%|███▊      | 59/154 [11:43<16:36, 10.49s/it, edit_acc=0, forget_acc=1, inject_loss=7.09, retain_loss=3.36, sft_loss=2.17] 39%|███▉      | 60/154 [11:45<16:22, 10.45s/it, edit_acc=0, forget_acc=1, inject_loss=7.09, retain_loss=3.36, sft_loss=2.17] 39%|███▉      | 60/154 [11:54<16:22, 10.45s/it, edit_acc=0, forget_acc=1, inject_loss=5.73, retain_loss=3.98, sft_loss=7.8]  40%|███▉      | 61/154 [11:55<16:09, 10.42s/it, edit_acc=0, forget_acc=1, inject_loss=5.73, retain_loss=3.98, sft_loss=7.8] 40%|███▉      | 61/154 [12:04<16:09, 10.42s/it, edit_acc=0, forget_acc=1, inject_loss=7.3, retain_loss=3.6, sft_loss=5.03]  40%|████      | 62/154 [12:05<15:58, 10.42s/it, edit_acc=0, forget_acc=1, inject_loss=7.3, retain_loss=3.6, sft_loss=5.03] 40%|████      | 62/154 [12:14<15:58, 10.42s/it, edit_acc=0, forget_acc=1, inject_loss=6.87, retain_loss=2.75, sft_loss=7.85] 41%|████      | 63/154 [12:15<15:24, 10.15s/it, edit_acc=0, forget_acc=1, inject_loss=6.87, retain_loss=2.75, sft_loss=7.85] 41%|████      | 63/154 [12:24<15:24, 10.15s/it, edit_acc=0, forget_acc=1, inject_loss=5.53, retain_loss=3.98, sft_loss=5.08] 42%|████▏     | 64/154 [12:25<15:20, 10.22s/it, edit_acc=0, forget_acc=1, inject_loss=5.53, retain_loss=3.98, sft_loss=5.08] 42%|████▏     | 64/154 [12:34<15:20, 10.22s/it, edit_acc=0, forget_acc=1, inject_loss=5.27, retain_loss=2.84, sft_loss=2.72] 42%|████▏     | 65/154 [12:36<15:15, 10.28s/it, edit_acc=0, forget_acc=1, inject_loss=5.27, retain_loss=2.84, sft_loss=2.72] 42%|████▏     | 65/154 [12:44<15:15, 10.28s/it, edit_acc=0, forget_acc=1, inject_loss=4.32, retain_loss=2.94, sft_loss=10.4] 43%|████▎     | 66/154 [12:45<14:46, 10.07s/it, edit_acc=0, forget_acc=1, inject_loss=4.32, retain_loss=2.94, sft_loss=10.4] 43%|████▎     | 66/154 [12:55<14:46, 10.07s/it, edit_acc=0, forget_acc=1, inject_loss=6.58, retain_loss=2.97, sft_loss=7.43] 44%|████▎     | 67/154 [12:56<14:51, 10.24s/it, edit_acc=0, forget_acc=1, inject_loss=6.58, retain_loss=2.97, sft_loss=7.43] 44%|████▎     | 67/154 [13:05<14:51, 10.24s/it, edit_acc=0, forget_acc=1, inject_loss=8.18, retain_loss=3.36, sft_loss=2.51] 44%|████▍     | 68/154 [13:06<14:34, 10.17s/it, edit_acc=0, forget_acc=1, inject_loss=8.18, retain_loss=3.36, sft_loss=2.51] 44%|████▍     | 68/154 [13:15<14:34, 10.17s/it, edit_acc=1, forget_acc=0, inject_loss=5.6, retain_loss=3.64, sft_loss=2.36]  45%|████▍     | 69/154 [13:16<14:20, 10.12s/it, edit_acc=1, forget_acc=0, inject_loss=5.6, retain_loss=3.64, sft_loss=2.36] 45%|████▍     | 69/154 [13:25<14:20, 10.12s/it, edit_acc=0, forget_acc=1, inject_loss=5.62, retain_loss=2.29, sft_loss=6.52] 45%|████▌     | 70/154 [13:26<14:17, 10.21s/it, edit_acc=0, forget_acc=1, inject_loss=5.62, retain_loss=2.29, sft_loss=6.52] 45%|████▌     | 70/154 [13:35<14:17, 10.21s/it, edit_acc=1, forget_acc=0, inject_loss=3.71, retain_loss=3.71, sft_loss=5.21] 46%|████▌     | 71/154 [13:36<13:58, 10.10s/it, edit_acc=1, forget_acc=0, inject_loss=3.71, retain_loss=3.71, sft_loss=5.21] 46%|████▌     | 71/154 [13:45<13:58, 10.10s/it, edit_acc=1, forget_acc=0, inject_loss=7.77, retain_loss=3.34, sft_loss=4.45] 47%|████▋     | 72/154 [13:46<13:50, 10.13s/it, edit_acc=1, forget_acc=0, inject_loss=7.77, retain_loss=3.34, sft_loss=4.45] 47%|████▋     | 72/154 [13:56<13:50, 10.13s/it, edit_acc=0, forget_acc=1, inject_loss=5.37, retain_loss=3.57, sft_loss=1.95] 47%|████▋     | 73/154 [13:57<13:45, 10.19s/it, edit_acc=0, forget_acc=1, inject_loss=5.37, retain_loss=3.57, sft_loss=1.95] 47%|████▋     | 73/154 [14:04<13:45, 10.19s/it, edit_acc=0, forget_acc=1, inject_loss=5.25, retain_loss=2.84, sft_loss=4.5]  48%|████▊     | 74/154 [14:06<13:01,  9.77s/it, edit_acc=0, forget_acc=1, inject_loss=5.25, retain_loss=2.84, sft_loss=4.5] 48%|████▊     | 74/154 [14:14<13:01,  9.77s/it, edit_acc=0, forget_acc=1, inject_loss=4.82, retain_loss=4.37, sft_loss=4.48] 49%|████▊     | 75/154 [14:16<12:59,  9.87s/it, edit_acc=0, forget_acc=1, inject_loss=4.82, retain_loss=4.37, sft_loss=4.48] 49%|████▊     | 75/154 [14:24<12:59,  9.87s/it, edit_acc=0, forget_acc=1, inject_loss=4.03, retain_loss=2.12, sft_loss=3.32] 49%|████▉     | 76/154 [14:26<12:50,  9.88s/it, edit_acc=0, forget_acc=1, inject_loss=4.03, retain_loss=2.12, sft_loss=3.32] 49%|████▉     | 76/154 [14:37<12:50,  9.88s/it, edit_acc=0, forget_acc=1, inject_loss=5.2, retain_loss=1.69, sft_loss=2.62]  50%|█████     | 77/154 [14:39<13:56, 10.87s/it, edit_acc=0, forget_acc=1, inject_loss=5.2, retain_loss=1.69, sft_loss=2.62] 50%|█████     | 77/154 [14:48<13:56, 10.87s/it, edit_acc=0, forget_acc=1, inject_loss=2.99, retain_loss=2.54, sft_loss=2.51] 51%|█████     | 78/154 [14:49<13:28, 10.64s/it, edit_acc=0, forget_acc=1, inject_loss=2.99, retain_loss=2.54, sft_loss=2.51] 51%|█████     | 78/154 [14:58<13:28, 10.64s/it, edit_acc=0, forget_acc=1, inject_loss=3.89, retain_loss=2.37, sft_loss=2.54] 51%|█████▏    | 79/154 [14:59<13:04, 10.46s/it, edit_acc=0, forget_acc=1, inject_loss=3.89, retain_loss=2.37, sft_loss=2.54] 51%|█████▏    | 79/154 [15:08<13:04, 10.46s/it, edit_acc=1, forget_acc=0, inject_loss=3.57, retain_loss=2.1, sft_loss=7.54]  52%|█████▏    | 80/154 [15:09<12:51, 10.43s/it, edit_acc=1, forget_acc=0, inject_loss=3.57, retain_loss=2.1, sft_loss=7.54] 52%|█████▏    | 80/154 [15:19<12:51, 10.43s/it, edit_acc=0, forget_acc=1, inject_loss=7.59, retain_loss=1.96, sft_loss=7.99] 53%|█████▎    | 81/154 [15:20<12:42, 10.45s/it, edit_acc=0, forget_acc=1, inject_loss=7.59, retain_loss=1.96, sft_loss=7.99] 53%|█████▎    | 81/154 [15:29<12:42, 10.45s/it, edit_acc=0, forget_acc=1, inject_loss=6.49, retain_loss=1.7, sft_loss=4.48]  53%|█████▎    | 82/154 [15:30<12:22, 10.31s/it, edit_acc=0, forget_acc=1, inject_loss=6.49, retain_loss=1.7, sft_loss=4.48] 53%|█████▎    | 82/154 [15:39<12:22, 10.31s/it, edit_acc=0, forget_acc=1, inject_loss=7.97, retain_loss=2.45, sft_loss=4.47] 54%|█████▍    | 83/154 [15:40<12:11, 10.31s/it, edit_acc=0, forget_acc=1, inject_loss=7.97, retain_loss=2.45, sft_loss=4.47] 54%|█████▍    | 83/154 [15:49<12:11, 10.31s/it, edit_acc=0, forget_acc=1, inject_loss=4.25, retain_loss=3.47, sft_loss=3.86] 55%|█████▍    | 84/154 [15:50<11:54, 10.20s/it, edit_acc=0, forget_acc=1, inject_loss=4.25, retain_loss=3.47, sft_loss=3.86] 55%|█████▍    | 84/154 [15:59<11:54, 10.20s/it, edit_acc=0, forget_acc=1, inject_loss=3.79, retain_loss=2.47, sft_loss=2.39] 55%|█████▌    | 85/154 [16:00<11:43, 10.19s/it, edit_acc=0, forget_acc=1, inject_loss=3.79, retain_loss=2.47, sft_loss=2.39] 55%|█████▌    | 85/154 [16:09<11:43, 10.19s/it, edit_acc=0.5, forget_acc=0.5, inject_loss=5.42, retain_loss=2.76, sft_loss=6.24] 56%|█████▌    | 86/154 [16:10<11:23, 10.06s/it, edit_acc=0.5, forget_acc=0.5, inject_loss=5.42, retain_loss=2.76, sft_loss=6.24] 56%|█████▌    | 86/154 [16:19<11:23, 10.06s/it, edit_acc=0, forget_acc=1, inject_loss=4.31, retain_loss=2.6, sft_loss=4]         56%|█████▋    | 87/154 [16:20<11:15, 10.08s/it, edit_acc=0, forget_acc=1, inject_loss=4.31, retain_loss=2.6, sft_loss=4] 56%|█████▋    | 87/154 [16:28<11:15, 10.08s/it, edit_acc=0.333, forget_acc=0.667, inject_loss=4.63, retain_loss=2.87, sft_loss=6.27] 57%|█████▋    | 88/154 [16:29<10:46,  9.79s/it, edit_acc=0.333, forget_acc=0.667, inject_loss=4.63, retain_loss=2.87, sft_loss=6.27] 57%|█████▋    | 88/154 [16:41<10:46,  9.79s/it, edit_acc=0, forget_acc=1, inject_loss=2.92, retain_loss=1.86, sft_loss=7.84]         58%|█████▊    | 89/154 [16:42<11:32, 10.66s/it, edit_acc=0, forget_acc=1, inject_loss=2.92, retain_loss=1.86, sft_loss=7.84] 58%|█████▊    | 89/154 [16:53<11:32, 10.66s/it, edit_acc=0, forget_acc=1, inject_loss=6.2, retain_loss=4.14, sft_loss=2.46]  58%|█████▊    | 90/154 [16:55<12:05, 11.34s/it, edit_acc=0, forget_acc=1, inject_loss=6.2, retain_loss=4.14, sft_loss=2.46] 58%|█████▊    | 90/154 [17:04<12:05, 11.34s/it, edit_acc=0, forget_acc=1, inject_loss=6.7, retain_loss=2.5, sft_loss=1.87]  59%|█████▉    | 91/154 [17:05<11:37, 11.07s/it, edit_acc=0, forget_acc=1, inject_loss=6.7, retain_loss=2.5, sft_loss=1.87] 59%|█████▉    | 91/154 [17:15<11:37, 11.07s/it, edit_acc=0, forget_acc=1, inject_loss=3.13, retain_loss=1.78, sft_loss=4.32] 60%|█████▉    | 92/154 [17:16<11:21, 10.99s/it, edit_acc=0, forget_acc=1, inject_loss=3.13, retain_loss=1.78, sft_loss=4.32] 60%|█████▉    | 92/154 [17:17<11:38, 11.27s/it, edit_acc=0, forget_acc=1, inject_loss=3.13, retain_loss=1.78, sft_loss=4.32]
Traceback (most recent call last):
  File "/root/mechanistic-unlearning/experiments/scaling_counterfact/finetune_scaling.py", line 173, in <module>
    loss.backward()
  File "/root/venv/lib/python3.10/site-packages/torch/_tensor.py", line 522, in backward
    torch.autograd.backward(
  File "/root/venv/lib/python3.10/site-packages/torch/autograd/__init__.py", line 266, in backward
    Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
RuntimeError: element 0 of tensors does not require grad and does not have a grad_fn
Traceback (most recent call last):
  File "/root/mechanistic-unlearning/experiments/scaling_counterfact/finetune_scaling.py", line 173, in <module>
    loss.backward()
  File "/root/venv/lib/python3.10/site-packages/torch/_tensor.py", line 522, in backward
    torch.autograd.backward(
  File "/root/venv/lib/python3.10/site-packages/torch/autograd/__init__.py", line 266, in backward
    Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
RuntimeError: element 0 of tensors does not require grad and does not have a grad_fn
wandb: - 0.008 MB of 0.013 MB uploadedwandb: 
wandb: Run history:
wandb:    edit_acc ▁▁▁▁▁▁█▁▁▁▁█▁▁█▁▁▃▁▁▁▁▁▁█▃▁▁▁▁██▁▁▁▁▁▅▁▁
wandb:  forget_acc ██████▁████▁██▁██▆██████▁▆████▁▁█████▅██
wandb: inject_loss ▅▅█▂▅▆▅▅▄▅▃▃▅▅▂▅▄▃▄█▅▂█▅▁▂▆▃▃▂▃▂▃▂▂▄▂▃▁▂
wandb: retain_loss █▄▄▄▃▇▄▃▅▄▄▄▄▁▄▂▂▄▄▂▂▃▃▃▅▅▂▅▅▃▄▄▃▂▂▁▄▃▁▁
wandb:    sft_loss ▆▁▆▁▁▆▁▃▃▅▃▄▁▁▃▆▄▁▄█▆▃▃▁▅▁▅▅▃▇▁▃▃▂▁▅▂▄▅▃
wandb: 
wandb: Run summary:
wandb:    edit_acc 0.0
wandb:  forget_acc 1.0
wandb: inject_loss 3.12888
wandb: retain_loss 1.78451
wandb:    sft_loss 4.31725
wandb: 
wandb: 🚀 View run cfact_scale_google_gemma-7b_300facts at: https://wandb.ai/aaquib111/mech-unlearning/runs/rm7yet77
wandb: ⭐️ View project at: https://wandb.ai/aaquib111/mech-unlearning
wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20250330_204151-rm7yet77/logs
