`config.hidden_act` is ignored, you should use `config.hidden_activation` instead.
Gemma's activation function will be set to `gelu_pytorch_tanh`. Please, use
`config.hidden_activation` if you want to override this behaviour.
See https://github.com/huggingface/transformers/pull/29402 for more details.
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Loading checkpoint shards:  25%|██▌       | 1/4 [00:02<00:07,  2.63s/it]Loading checkpoint shards:  50%|█████     | 2/4 [00:04<00:04,  2.44s/it]Loading checkpoint shards:  75%|███████▌  | 3/4 [00:07<00:02,  2.31s/it]Loading checkpoint shards: 100%|██████████| 4/4 [00:08<00:00,  1.80s/it]Loading checkpoint shards: 100%|██████████| 4/4 [00:08<00:00,  2.03s/it]
WARNING:root:You are not using LayerNorm, so the writing weights can't be centered! Skipping
wandb: Currently logged in as: aaquib111. Use `wandb login --relogin` to force relogin
wandb: wandb version 0.19.8 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.6
wandb: Run data is saved locally in /root/mechanistic-unlearning/experiments/scaling_counterfact/wandb/run-20250330_201356-b1hcx9pk
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run cfact_scale_google_gemma-7b_30facts
wandb: ⭐️ View project at https://wandb.ai/aaquib111/mech-unlearning
wandb: 🚀 View run at https://wandb.ai/aaquib111/mech-unlearning/runs/b1hcx9pk
Loaded pretrained model google/gemma-7b into HookedTransformer
  0%|          | 0/27 [00:00<?, ?it/s]  0%|          | 0/27 [00:10<?, ?it/s, edit_acc=0, forget_acc=1, inject_loss=4.62, retain_loss=6.17, sft_loss=9.62]  4%|▎         | 1/27 [00:11<04:58, 11.49s/it, edit_acc=0, forget_acc=1, inject_loss=4.62, retain_loss=6.17, sft_loss=9.62]  4%|▎         | 1/27 [00:20<04:58, 11.49s/it, edit_acc=0, forget_acc=1, inject_loss=7.93, retain_loss=3.31, sft_loss=9.74]  7%|▋         | 2/27 [00:21<04:30, 10.82s/it, edit_acc=0, forget_acc=1, inject_loss=7.93, retain_loss=3.31, sft_loss=9.74]  7%|▋         | 2/27 [00:30<04:30, 10.82s/it, edit_acc=0, forget_acc=1, inject_loss=13.2, retain_loss=3.8, sft_loss=2.14]  11%|█         | 3/27 [00:31<04:04, 10.19s/it, edit_acc=0, forget_acc=1, inject_loss=13.2, retain_loss=3.8, sft_loss=2.14] 11%|█         | 3/27 [00:43<04:04, 10.19s/it, edit_acc=0, forget_acc=1, inject_loss=9, retain_loss=4.32, sft_loss=5.99]   15%|█▍        | 4/27 [00:44<04:19, 11.30s/it, edit_acc=0, forget_acc=1, inject_loss=9, retain_loss=4.32, sft_loss=5.99] 15%|█▍        | 4/27 [00:53<04:19, 11.30s/it, edit_acc=0, forget_acc=1, inject_loss=3.6, retain_loss=3.14, sft_loss=6.13] 19%|█▊        | 5/27 [00:54<04:00, 10.92s/it, edit_acc=0, forget_acc=1, inject_loss=3.6, retain_loss=3.14, sft_loss=6.13] 19%|█▊        | 5/27 [01:03<04:00, 10.92s/it, edit_acc=0, forget_acc=1, inject_loss=10.8, retain_loss=3.48, sft_loss=9.27] 22%|██▏       | 6/27 [01:04<03:43, 10.66s/it, edit_acc=0, forget_acc=1, inject_loss=10.8, retain_loss=3.48, sft_loss=9.27] 22%|██▏       | 6/27 [01:13<03:43, 10.66s/it, edit_acc=0, forget_acc=1, inject_loss=8.24, retain_loss=5.01, sft_loss=5.5]  26%|██▌       | 7/27 [01:14<03:25, 10.29s/it, edit_acc=0, forget_acc=1, inject_loss=8.24, retain_loss=5.01, sft_loss=5.5] 26%|██▌       | 7/27 [01:23<03:25, 10.29s/it, edit_acc=0, forget_acc=1, inject_loss=9.32, retain_loss=3.57, sft_loss=2.39] 30%|██▉       | 8/27 [01:24<03:16, 10.32s/it, edit_acc=0, forget_acc=1, inject_loss=9.32, retain_loss=3.57, sft_loss=2.39] 30%|██▉       | 8/27 [01:33<03:16, 10.32s/it, edit_acc=0, forget_acc=1, inject_loss=11.5, retain_loss=5.82, sft_loss=9.33] 33%|███▎      | 9/27 [01:35<03:06, 10.35s/it, edit_acc=0, forget_acc=1, inject_loss=11.5, retain_loss=5.82, sft_loss=9.33] 33%|███▎      | 9/27 [01:43<03:06, 10.35s/it, edit_acc=0, forget_acc=1, inject_loss=13.9, retain_loss=2.62, sft_loss=6.21] 37%|███▋      | 10/27 [01:45<02:54, 10.26s/it, edit_acc=0, forget_acc=1, inject_loss=13.9, retain_loss=2.62, sft_loss=6.21] 37%|███▋      | 10/27 [01:54<02:54, 10.26s/it, edit_acc=0, forget_acc=1, inject_loss=9.51, retain_loss=3.32, sft_loss=2.26] 41%|████      | 11/27 [01:55<02:44, 10.28s/it, edit_acc=0, forget_acc=1, inject_loss=9.51, retain_loss=3.32, sft_loss=2.26] 41%|████      | 11/27 [02:01<02:44, 10.28s/it, edit_acc=1, forget_acc=0, inject_loss=2.02, retain_loss=2.3, sft_loss=2.64]  44%|████▍     | 12/27 [02:02<02:20,  9.36s/it, edit_acc=1, forget_acc=0, inject_loss=2.02, retain_loss=2.3, sft_loss=2.64] 44%|████▍     | 12/27 [02:11<02:20,  9.36s/it, edit_acc=1, forget_acc=0, inject_loss=9.18, retain_loss=5.06, sft_loss=8.75] 48%|████▊     | 13/27 [02:12<02:15,  9.65s/it, edit_acc=1, forget_acc=0, inject_loss=9.18, retain_loss=5.06, sft_loss=8.75] 48%|████▊     | 13/27 [02:21<02:15,  9.65s/it, edit_acc=0, forget_acc=1, inject_loss=10.8, retain_loss=3.37, sft_loss=2.43] 52%|█████▏    | 14/27 [02:23<02:07,  9.81s/it, edit_acc=0, forget_acc=1, inject_loss=10.8, retain_loss=3.37, sft_loss=2.43] 52%|█████▏    | 14/27 [02:32<02:07,  9.81s/it, edit_acc=0.333, forget_acc=0.667, inject_loss=8.55, retain_loss=3.13, sft_loss=5.79] 56%|█████▌    | 15/27 [02:33<02:00, 10.04s/it, edit_acc=0.333, forget_acc=0.667, inject_loss=8.55, retain_loss=3.13, sft_loss=5.79] 56%|█████▌    | 15/27 [02:43<02:00, 10.04s/it, edit_acc=0, forget_acc=1, inject_loss=10.8, retain_loss=3.98, sft_loss=2.45]         59%|█████▉    | 16/27 [02:44<01:51, 10.18s/it, edit_acc=0, forget_acc=1, inject_loss=10.8, retain_loss=3.98, sft_loss=2.45] 59%|█████▉    | 16/27 [02:52<01:51, 10.18s/it, edit_acc=0, forget_acc=1, inject_loss=11.4, retain_loss=2.95, sft_loss=6.07] 63%|██████▎   | 17/27 [02:54<01:41, 10.12s/it, edit_acc=0, forget_acc=1, inject_loss=11.4, retain_loss=2.95, sft_loss=6.07] 63%|██████▎   | 17/27 [03:03<01:41, 10.12s/it, edit_acc=0, forget_acc=1, inject_loss=13.1, retain_loss=3.09, sft_loss=5.49] 67%|██████▋   | 18/27 [03:04<01:31, 10.16s/it, edit_acc=0, forget_acc=1, inject_loss=13.1, retain_loss=3.09, sft_loss=5.49] 67%|██████▋   | 18/27 [03:12<01:31, 10.16s/it, edit_acc=0, forget_acc=1, inject_loss=11, retain_loss=3.02, sft_loss=5.81]   70%|███████   | 19/27 [03:13<01:18,  9.82s/it, edit_acc=0, forget_acc=1, inject_loss=11, retain_loss=3.02, sft_loss=5.81] 70%|███████   | 19/27 [03:21<01:18,  9.82s/it, edit_acc=0, forget_acc=1, inject_loss=7.75, retain_loss=3.79, sft_loss=5.91] 74%|███████▍  | 20/27 [03:23<01:08,  9.74s/it, edit_acc=0, forget_acc=1, inject_loss=7.75, retain_loss=3.79, sft_loss=5.91] 74%|███████▍  | 20/27 [03:31<01:08,  9.74s/it, edit_acc=0, forget_acc=1, inject_loss=6.23, retain_loss=4.07, sft_loss=5.35] 78%|███████▊  | 21/27 [03:33<00:58,  9.82s/it, edit_acc=0, forget_acc=1, inject_loss=6.23, retain_loss=4.07, sft_loss=5.35] 78%|███████▊  | 21/27 [03:41<00:58,  9.82s/it, edit_acc=0, forget_acc=1, inject_loss=7.93, retain_loss=2.14, sft_loss=2.48] 81%|████████▏ | 22/27 [03:42<00:48,  9.80s/it, edit_acc=0, forget_acc=1, inject_loss=7.93, retain_loss=2.14, sft_loss=2.48] 81%|████████▏ | 22/27 [03:51<00:48,  9.80s/it, edit_acc=1, forget_acc=0, inject_loss=6.89, retain_loss=3.79, sft_loss=8.36] 85%|████████▌ | 23/27 [03:52<00:39,  9.92s/it, edit_acc=1, forget_acc=0, inject_loss=6.89, retain_loss=3.79, sft_loss=8.36] 85%|████████▌ | 23/27 [04:02<00:39,  9.92s/it, edit_acc=1, forget_acc=0, inject_loss=7.7, retain_loss=2.77, sft_loss=2.79]  89%|████████▉ | 24/27 [04:03<00:30, 10.07s/it, edit_acc=1, forget_acc=0, inject_loss=7.7, retain_loss=2.77, sft_loss=2.79] 89%|████████▉ | 24/27 [04:12<00:30, 10.07s/it, edit_acc=0, forget_acc=1, inject_loss=9.63, retain_loss=2.44, sft_loss=2.26] 93%|█████████▎| 25/27 [04:13<00:20, 10.02s/it, edit_acc=0, forget_acc=1, inject_loss=9.63, retain_loss=2.44, sft_loss=2.26] 93%|█████████▎| 25/27 [04:22<00:20, 10.02s/it, edit_acc=0, forget_acc=1, inject_loss=8.75, retain_loss=3.14, sft_loss=5.28] 96%|█████████▋| 26/27 [04:23<00:10, 10.08s/it, edit_acc=0, forget_acc=1, inject_loss=8.75, retain_loss=3.14, sft_loss=5.28] 96%|█████████▋| 26/27 [04:32<00:10, 10.08s/it, edit_acc=0, forget_acc=1, inject_loss=5.36, retain_loss=2.26, sft_loss=5.79]100%|██████████| 27/27 [04:33<00:00, 10.10s/it, edit_acc=0, forget_acc=1, inject_loss=5.36, retain_loss=2.26, sft_loss=5.79]100%|██████████| 27/27 [04:33<00:00, 10.14s/it, edit_acc=0, forget_acc=1, inject_loss=5.36, retain_loss=2.26, sft_loss=5.79]
  0%|          | 0/27 [00:00<?, ?it/s]  0%|          | 0/27 [00:08<?, ?it/s, edit_acc=1, forget_acc=0, inject_loss=1.05, retain_loss=3.9, sft_loss=6.03]  4%|▎         | 1/27 [00:10<04:23, 10.13s/it, edit_acc=1, forget_acc=0, inject_loss=1.05, retain_loss=3.9, sft_loss=6.03]  4%|▎         | 1/27 [00:19<04:23, 10.13s/it, edit_acc=0, forget_acc=1, inject_loss=1.71, retain_loss=4.01, sft_loss=2.45]  7%|▋         | 2/27 [00:20<04:15, 10.20s/it, edit_acc=0, forget_acc=1, inject_loss=1.71, retain_loss=4.01, sft_loss=2.45]  7%|▋         | 2/27 [00:28<04:15, 10.20s/it, edit_acc=0, forget_acc=1, inject_loss=3.47, retain_loss=2, sft_loss=2.33]    11%|█         | 3/27 [00:29<03:56,  9.86s/it, edit_acc=0, forget_acc=1, inject_loss=3.47, retain_loss=2, sft_loss=2.33] 11%|█         | 3/27 [00:39<03:56,  9.86s/it, edit_acc=1, forget_acc=0, inject_loss=7.73, retain_loss=3.53, sft_loss=2.55] 15%|█▍        | 4/27 [00:40<03:54, 10.20s/it, edit_acc=1, forget_acc=0, inject_loss=7.73, retain_loss=3.53, sft_loss=2.55] 15%|█▍        | 4/27 [00:49<03:54, 10.20s/it, edit_acc=1, forget_acc=0, inject_loss=1.23, retain_loss=2.54, sft_loss=5.79] 19%|█▊        | 5/27 [00:50<03:45, 10.24s/it, edit_acc=1, forget_acc=0, inject_loss=1.23, retain_loss=2.54, sft_loss=5.79] 19%|█▊        | 5/27 [00:59<03:45, 10.24s/it, edit_acc=1, forget_acc=0, inject_loss=4.88, retain_loss=1.72, sft_loss=1.91] 22%|██▏       | 6/27 [01:00<03:32, 10.11s/it, edit_acc=1, forget_acc=0, inject_loss=4.88, retain_loss=1.72, sft_loss=1.91] 22%|██▏       | 6/27 [01:09<03:32, 10.11s/it, edit_acc=0, forget_acc=1, inject_loss=6.45, retain_loss=1.94, sft_loss=6.43] 26%|██▌       | 7/27 [01:10<03:18,  9.94s/it, edit_acc=0, forget_acc=1, inject_loss=6.45, retain_loss=1.94, sft_loss=6.43] 26%|██▌       | 7/27 [01:19<03:18,  9.94s/it, edit_acc=0, forget_acc=1, inject_loss=4.52, retain_loss=2.25, sft_loss=5.74] 30%|██▉       | 8/27 [01:20<03:11, 10.09s/it, edit_acc=0, forget_acc=1, inject_loss=4.52, retain_loss=2.25, sft_loss=5.74] 30%|██▉       | 8/27 [01:30<03:11, 10.09s/it, edit_acc=0, forget_acc=1, inject_loss=5, retain_loss=3.23, sft_loss=5.47]    33%|███▎      | 9/27 [01:31<03:04, 10.25s/it, edit_acc=0, forget_acc=1, inject_loss=5, retain_loss=3.23, sft_loss=5.47] 33%|███▎      | 9/27 [01:40<03:04, 10.25s/it, edit_acc=0, forget_acc=1, inject_loss=5.64, retain_loss=2.3, sft_loss=9.12] 37%|███▋      | 10/27 [01:41<02:54, 10.24s/it, edit_acc=0, forget_acc=1, inject_loss=5.64, retain_loss=2.3, sft_loss=9.12] 37%|███▋      | 10/27 [01:51<02:54, 10.24s/it, edit_acc=0, forget_acc=1, inject_loss=1.69, retain_loss=2.43, sft_loss=9.29] 41%|████      | 11/27 [01:52<02:46, 10.39s/it, edit_acc=0, forget_acc=1, inject_loss=1.69, retain_loss=2.43, sft_loss=9.29] 41%|████      | 11/27 [01:58<02:46, 10.39s/it, edit_acc=0, forget_acc=1, inject_loss=1.14, retain_loss=3.27, sft_loss=2.31] 44%|████▍     | 12/27 [01:59<02:22,  9.47s/it, edit_acc=0, forget_acc=1, inject_loss=1.14, retain_loss=3.27, sft_loss=2.31] 44%|████▍     | 12/27 [02:08<02:22,  9.47s/it, edit_acc=0, forget_acc=1, inject_loss=10, retain_loss=3.39, sft_loss=5.48]   48%|████▊     | 13/27 [02:09<02:15,  9.71s/it, edit_acc=0, forget_acc=1, inject_loss=10, retain_loss=3.39, sft_loss=5.48] 48%|████▊     | 13/27 [02:18<02:15,  9.71s/it, edit_acc=0, forget_acc=1, inject_loss=7.5, retain_loss=1.87, sft_loss=5.94] 52%|█████▏    | 14/27 [02:20<02:08,  9.86s/it, edit_acc=0, forget_acc=1, inject_loss=7.5, retain_loss=1.87, sft_loss=5.94] 52%|█████▏    | 14/27 [02:29<02:08,  9.86s/it, edit_acc=0.667, forget_acc=0.333, inject_loss=5.51, retain_loss=2.69, sft_loss=8.34] 56%|█████▌    | 15/27 [02:30<02:00, 10.05s/it, edit_acc=0.667, forget_acc=0.333, inject_loss=5.51, retain_loss=2.69, sft_loss=8.34] 56%|█████▌    | 15/27 [02:39<02:00, 10.05s/it, edit_acc=0, forget_acc=1, inject_loss=5.64, retain_loss=2.78, sft_loss=2.55]         59%|█████▉    | 16/27 [02:41<01:52, 10.20s/it, edit_acc=0, forget_acc=1, inject_loss=5.64, retain_loss=2.78, sft_loss=2.55] 59%|█████▉    | 16/27 [02:49<01:52, 10.20s/it, edit_acc=0, forget_acc=1, inject_loss=6.44, retain_loss=3.82, sft_loss=5.57] 63%|██████▎   | 17/27 [02:51<01:41, 10.12s/it, edit_acc=0, forget_acc=1, inject_loss=6.44, retain_loss=3.82, sft_loss=5.57] 63%|██████▎   | 17/27 [03:00<01:41, 10.12s/it, edit_acc=0, forget_acc=1, inject_loss=10, retain_loss=2.98, sft_loss=5.56]   67%|██████▋   | 18/27 [03:01<01:31, 10.19s/it, edit_acc=0, forget_acc=1, inject_loss=10, retain_loss=2.98, sft_loss=5.56] 67%|██████▋   | 18/27 [03:09<01:31, 10.19s/it, edit_acc=0, forget_acc=1, inject_loss=8.43, retain_loss=3.61, sft_loss=5.74] 70%|███████   | 19/27 [03:10<01:18,  9.87s/it, edit_acc=0, forget_acc=1, inject_loss=8.43, retain_loss=3.61, sft_loss=5.74] 70%|███████   | 19/27 [03:18<01:18,  9.87s/it, edit_acc=0, forget_acc=1, inject_loss=3.54, retain_loss=3.27, sft_loss=2.42] 74%|███████▍  | 20/27 [03:20<01:08,  9.78s/it, edit_acc=0, forget_acc=1, inject_loss=3.54, retain_loss=3.27, sft_loss=2.42] 74%|███████▍  | 20/27 [03:28<01:08,  9.78s/it, edit_acc=1, forget_acc=0, inject_loss=0.38, retain_loss=2.14, sft_loss=11.9] 78%|███████▊  | 21/27 [03:30<00:59,  9.85s/it, edit_acc=1, forget_acc=0, inject_loss=0.38, retain_loss=2.14, sft_loss=11.9] 78%|███████▊  | 21/27 [03:38<00:59,  9.85s/it, edit_acc=0, forget_acc=1, inject_loss=5.01, retain_loss=3.87, sft_loss=15.6] 81%|████████▏ | 22/27 [03:39<00:48,  9.77s/it, edit_acc=0, forget_acc=1, inject_loss=5.01, retain_loss=3.87, sft_loss=15.6] 81%|████████▏ | 22/27 [03:48<00:48,  9.77s/it, edit_acc=1, forget_acc=0, inject_loss=2.89, retain_loss=2.43, sft_loss=12.5] 85%|████████▌ | 23/27 [03:49<00:39,  9.91s/it, edit_acc=1, forget_acc=0, inject_loss=2.89, retain_loss=2.43, sft_loss=12.5] 85%|████████▌ | 23/27 [03:59<00:39,  9.91s/it, edit_acc=1, forget_acc=0, inject_loss=3.21, retain_loss=1.61, sft_loss=8.81] 89%|████████▉ | 24/27 [04:00<00:30, 10.08s/it, edit_acc=1, forget_acc=0, inject_loss=3.21, retain_loss=1.61, sft_loss=8.81] 89%|████████▉ | 24/27 [04:08<00:30, 10.08s/it, edit_acc=0, forget_acc=1, inject_loss=8.01, retain_loss=4.51, sft_loss=5.39] 93%|█████████▎| 25/27 [04:10<00:19,  9.99s/it, edit_acc=0, forget_acc=1, inject_loss=8.01, retain_loss=4.51, sft_loss=5.39] 93%|█████████▎| 25/27 [04:19<00:19,  9.99s/it, edit_acc=0, forget_acc=1, inject_loss=5.99, retain_loss=2.48, sft_loss=5.43] 96%|█████████▋| 26/27 [04:20<00:10, 10.06s/it, edit_acc=0, forget_acc=1, inject_loss=5.99, retain_loss=2.48, sft_loss=5.43] 96%|█████████▋| 26/27 [04:29<00:10, 10.06s/it, edit_acc=1, forget_acc=0, inject_loss=1.28, retain_loss=2.63, sft_loss=4.82]100%|██████████| 27/27 [04:30<00:00, 10.11s/it, edit_acc=1, forget_acc=0, inject_loss=1.28, retain_loss=2.63, sft_loss=4.82]100%|██████████| 27/27 [04:30<00:00, 10.02s/it, edit_acc=1, forget_acc=0, inject_loss=1.28, retain_loss=2.63, sft_loss=4.82]
  0%|          | 0/27 [00:00<?, ?it/s]  0%|          | 0/27 [00:09<?, ?it/s, edit_acc=0, forget_acc=1, inject_loss=0.818, retain_loss=3.04, sft_loss=5.21]  4%|▎         | 1/27 [00:10<04:33, 10.50s/it, edit_acc=0, forget_acc=1, inject_loss=0.818, retain_loss=3.04, sft_loss=5.21]  4%|▎         | 1/27 [00:19<04:33, 10.50s/it, edit_acc=1, forget_acc=0, inject_loss=0.805, retain_loss=3.33, sft_loss=5.21]  7%|▋         | 2/27 [00:20<04:19, 10.39s/it, edit_acc=1, forget_acc=0, inject_loss=0.805, retain_loss=3.33, sft_loss=5.21]  7%|▋         | 2/27 [00:29<04:19, 10.39s/it, edit_acc=1, forget_acc=0, inject_loss=0.402, retain_loss=2.45, sft_loss=2.3]  11%|█         | 3/27 [00:30<04:02, 10.09s/it, edit_acc=1, forget_acc=0, inject_loss=0.402, retain_loss=2.45, sft_loss=2.3] 11%|█         | 3/27 [00:39<04:02, 10.09s/it, edit_acc=1, forget_acc=0, inject_loss=7.06, retain_loss=2.56, sft_loss=2.17] 15%|█▍        | 4/27 [00:40<03:54, 10.19s/it, edit_acc=1, forget_acc=0, inject_loss=7.06, retain_loss=2.56, sft_loss=2.17] 15%|█▍        | 4/27 [00:49<03:54, 10.19s/it, edit_acc=1, forget_acc=0, inject_loss=0.354, retain_loss=1.73, sft_loss=5.59] 19%|█▊        | 5/27 [00:51<03:45, 10.26s/it, edit_acc=1, forget_acc=0, inject_loss=0.354, retain_loss=1.73, sft_loss=5.59] 19%|█▊        | 5/27 [01:00<03:45, 10.26s/it, edit_acc=1, forget_acc=0, inject_loss=1.61, retain_loss=2.08, sft_loss=4.3]   22%|██▏       | 6/27 [01:01<03:35, 10.27s/it, edit_acc=1, forget_acc=0, inject_loss=1.61, retain_loss=2.08, sft_loss=4.3] 22%|██▏       | 6/27 [01:10<03:35, 10.27s/it, edit_acc=1, forget_acc=0, inject_loss=1.17, retain_loss=4.21, sft_loss=7.52] 26%|██▌       | 7/27 [01:11<03:23, 10.17s/it, edit_acc=1, forget_acc=0, inject_loss=1.17, retain_loss=4.21, sft_loss=7.52] 26%|██▌       | 7/27 [01:20<03:23, 10.17s/it, edit_acc=1, forget_acc=0, inject_loss=0.398, retain_loss=2.34, sft_loss=5.4] 30%|██▉       | 8/27 [01:21<03:14, 10.22s/it, edit_acc=1, forget_acc=0, inject_loss=0.398, retain_loss=2.34, sft_loss=5.4] 30%|██▉       | 8/27 [01:31<03:14, 10.22s/it, edit_acc=1, forget_acc=0, inject_loss=1.04, retain_loss=4.15, sft_loss=2.52] 33%|███▎      | 9/27 [01:32<03:05, 10.30s/it, edit_acc=1, forget_acc=0, inject_loss=1.04, retain_loss=4.15, sft_loss=2.52] 33%|███▎      | 9/27 [01:41<03:05, 10.30s/it, edit_acc=1, forget_acc=0, inject_loss=1.45, retain_loss=1.58, sft_loss=7.77] 37%|███▋      | 10/27 [01:42<02:55, 10.35s/it, edit_acc=1, forget_acc=0, inject_loss=1.45, retain_loss=1.58, sft_loss=7.77] 37%|███▋      | 10/27 [01:51<02:55, 10.35s/it, edit_acc=1, forget_acc=0, inject_loss=0.456, retain_loss=3.86, sft_loss=2.61] 41%|████      | 11/27 [01:53<02:45, 10.34s/it, edit_acc=1, forget_acc=0, inject_loss=0.456, retain_loss=3.86, sft_loss=2.61] 41%|████      | 11/27 [01:59<02:45, 10.34s/it, edit_acc=1, forget_acc=0, inject_loss=0.531, retain_loss=1.38, sft_loss=7.55] 44%|████▍     | 12/27 [02:00<02:22,  9.47s/it, edit_acc=1, forget_acc=0, inject_loss=0.531, retain_loss=1.38, sft_loss=7.55] 44%|████▍     | 12/27 [02:09<02:22,  9.47s/it, edit_acc=0, forget_acc=1, inject_loss=7.65, retain_loss=3.03, sft_loss=2.1]   48%|████▊     | 13/27 [02:10<02:14,  9.62s/it, edit_acc=0, forget_acc=1, inject_loss=7.65, retain_loss=3.03, sft_loss=2.1] 48%|████▊     | 13/27 [02:19<02:14,  9.62s/it, edit_acc=0, forget_acc=1, inject_loss=6.32, retain_loss=2.53, sft_loss=7.36] 52%|█████▏    | 14/27 [02:20<02:07,  9.82s/it, edit_acc=0, forget_acc=1, inject_loss=6.32, retain_loss=2.53, sft_loss=7.36] 52%|█████▏    | 14/27 [02:30<02:07,  9.82s/it, edit_acc=0.667, forget_acc=0.333, inject_loss=3.47, retain_loss=2.33, sft_loss=4.88] 56%|█████▌    | 15/27 [02:31<01:59, 10.00s/it, edit_acc=0.667, forget_acc=0.333, inject_loss=3.47, retain_loss=2.33, sft_loss=4.88] 56%|█████▌    | 15/27 [02:40<01:59, 10.00s/it, edit_acc=1, forget_acc=0, inject_loss=0.69, retain_loss=2.01, sft_loss=7.74]         59%|█████▉    | 16/27 [02:41<01:51, 10.11s/it, edit_acc=1, forget_acc=0, inject_loss=0.69, retain_loss=2.01, sft_loss=7.74] 59%|█████▉    | 16/27 [02:50<01:51, 10.11s/it, edit_acc=1, forget_acc=0, inject_loss=1.92, retain_loss=3, sft_loss=4.95]    63%|██████▎   | 17/27 [02:51<01:40, 10.07s/it, edit_acc=1, forget_acc=0, inject_loss=1.92, retain_loss=3, sft_loss=4.95] 63%|██████▎   | 17/27 [03:00<01:40, 10.07s/it, edit_acc=0, forget_acc=1, inject_loss=8.7, retain_loss=2.54, sft_loss=2.66] 67%|██████▋   | 18/27 [03:01<01:31, 10.15s/it, edit_acc=0, forget_acc=1, inject_loss=8.7, retain_loss=2.54, sft_loss=2.66] 67%|██████▋   | 18/27 [03:09<01:31, 10.15s/it, edit_acc=0, forget_acc=1, inject_loss=6.55, retain_loss=2.41, sft_loss=10.4] 70%|███████   | 19/27 [03:11<01:18,  9.84s/it, edit_acc=0, forget_acc=1, inject_loss=6.55, retain_loss=2.41, sft_loss=10.4] 70%|███████   | 19/27 [03:19<01:18,  9.84s/it, edit_acc=0, forget_acc=1, inject_loss=1.47, retain_loss=2.1, sft_loss=7.62]  74%|███████▍  | 20/27 [03:20<01:08,  9.77s/it, edit_acc=0, forget_acc=1, inject_loss=1.47, retain_loss=2.1, sft_loss=7.62] 74%|███████▍  | 20/27 [03:29<01:08,  9.77s/it, edit_acc=1, forget_acc=0, inject_loss=0.0141, retain_loss=2.78, sft_loss=2.48] 78%|███████▊  | 21/27 [03:30<00:59,  9.85s/it, edit_acc=1, forget_acc=0, inject_loss=0.0141, retain_loss=2.78, sft_loss=2.48] 78%|███████▊  | 21/27 [03:38<00:59,  9.85s/it, edit_acc=1, forget_acc=0, inject_loss=2.61, retain_loss=3.13, sft_loss=2.26]   81%|████████▏ | 22/27 [03:40<00:48,  9.74s/it, edit_acc=1, forget_acc=0, inject_loss=2.61, retain_loss=3.13, sft_loss=2.26] 81%|████████▏ | 22/27 [03:49<00:48,  9.74s/it, edit_acc=1, forget_acc=0, inject_loss=0.698, retain_loss=1.97, sft_loss=6.79] 85%|████████▌ | 23/27 [03:50<00:39,  9.89s/it, edit_acc=1, forget_acc=0, inject_loss=0.698, retain_loss=1.97, sft_loss=6.79] 85%|████████▌ | 23/27 [03:59<00:39,  9.89s/it, edit_acc=1, forget_acc=0, inject_loss=1.3, retain_loss=3.44, sft_loss=5.29]   89%|████████▉ | 24/27 [04:00<00:30, 10.06s/it, edit_acc=1, forget_acc=0, inject_loss=1.3, retain_loss=3.44, sft_loss=5.29] 89%|████████▉ | 24/27 [04:09<00:30, 10.06s/it, edit_acc=0, forget_acc=1, inject_loss=6.32, retain_loss=3.19, sft_loss=4.49] 93%|█████████▎| 25/27 [04:10<00:20, 10.02s/it, edit_acc=0, forget_acc=1, inject_loss=6.32, retain_loss=3.19, sft_loss=4.49] 93%|█████████▎| 25/27 [04:19<00:20, 10.02s/it, edit_acc=1, forget_acc=0, inject_loss=0.946, retain_loss=2.98, sft_loss=1.89] 96%|█████████▋| 26/27 [04:21<00:10, 10.09s/it, edit_acc=1, forget_acc=0, inject_loss=0.946, retain_loss=2.98, sft_loss=1.89] 96%|█████████▋| 26/27 [04:29<00:10, 10.09s/it, edit_acc=1, forget_acc=0, inject_loss=0.309, retain_loss=1.88, sft_loss=4.56]100%|██████████| 27/27 [04:31<00:00, 10.11s/it, edit_acc=1, forget_acc=0, inject_loss=0.309, retain_loss=1.88, sft_loss=4.56]100%|██████████| 27/27 [04:31<00:00, 10.04s/it, edit_acc=1, forget_acc=0, inject_loss=0.309, retain_loss=1.88, sft_loss=4.56]
  0%|          | 0/27 [00:00<?, ?it/s]  0%|          | 0/27 [00:09<?, ?it/s, edit_acc=1, forget_acc=0, inject_loss=0.123, retain_loss=4.21, sft_loss=4.55]  4%|▎         | 1/27 [00:10<04:25, 10.20s/it, edit_acc=1, forget_acc=0, inject_loss=0.123, retain_loss=4.21, sft_loss=4.55]  4%|▎         | 1/27 [00:19<04:25, 10.20s/it, edit_acc=1, forget_acc=0, inject_loss=0.176, retain_loss=1.4, sft_loss=3.26]   7%|▋         | 2/27 [00:20<04:17, 10.30s/it, edit_acc=1, forget_acc=0, inject_loss=0.176, retain_loss=1.4, sft_loss=3.26]  7%|▋         | 2/27 [00:29<04:17, 10.30s/it, edit_acc=1, forget_acc=0, inject_loss=0.0774, retain_loss=1.42, sft_loss=2.54] 11%|█         | 3/27 [00:30<04:00, 10.02s/it, edit_acc=1, forget_acc=0, inject_loss=0.0774, retain_loss=1.42, sft_loss=2.54] 11%|█         | 3/27 [00:39<04:00, 10.02s/it, edit_acc=1, forget_acc=0, inject_loss=4.56, retain_loss=1.61, sft_loss=2.42]   15%|█▍        | 4/27 [00:40<03:53, 10.15s/it, edit_acc=1, forget_acc=0, inject_loss=4.56, retain_loss=1.61, sft_loss=2.42] 15%|█▍        | 4/27 [00:49<03:53, 10.15s/it, edit_acc=1, forget_acc=0, inject_loss=0.0599, retain_loss=0.98, sft_loss=2.44] 19%|█▊        | 5/27 [00:50<03:44, 10.20s/it, edit_acc=1, forget_acc=0, inject_loss=0.0599, retain_loss=0.98, sft_loss=2.44] 19%|█▊        | 5/27 [00:59<03:44, 10.20s/it, edit_acc=1, forget_acc=0, inject_loss=0.279, retain_loss=1.41, sft_loss=7.84]  22%|██▏       | 6/27 [01:00<03:32, 10.10s/it, edit_acc=1, forget_acc=0, inject_loss=0.279, retain_loss=1.41, sft_loss=7.84] 22%|██▏       | 6/27 [01:09<03:32, 10.10s/it, edit_acc=1, forget_acc=0, inject_loss=0.169, retain_loss=1.49, sft_loss=8.36] 26%|██▌       | 7/27 [01:10<03:18,  9.93s/it, edit_acc=1, forget_acc=0, inject_loss=0.169, retain_loss=1.49, sft_loss=8.36] 26%|██▌       | 7/27 [01:19<03:18,  9.93s/it, edit_acc=1, forget_acc=0, inject_loss=0.000284, retain_loss=1.26, sft_loss=4.53] 30%|██▉       | 8/27 [01:21<03:13, 10.17s/it, edit_acc=1, forget_acc=0, inject_loss=0.000284, retain_loss=1.26, sft_loss=4.53] 30%|██▉       | 8/27 [01:30<03:13, 10.17s/it, edit_acc=1, forget_acc=0, inject_loss=0.167, retain_loss=1.3, sft_loss=4.49]     33%|███▎      | 9/27 [01:32<03:11, 10.62s/it, edit_acc=1, forget_acc=0, inject_loss=0.167, retain_loss=1.3, sft_loss=4.49] 33%|███▎      | 9/27 [01:44<03:11, 10.62s/it, edit_acc=1, forget_acc=0, inject_loss=0.12, retain_loss=3.35, sft_loss=3.93] 37%|███▋      | 10/27 [01:45<03:13, 11.36s/it, edit_acc=1, forget_acc=0, inject_loss=0.12, retain_loss=3.35, sft_loss=3.93] 37%|███▋      | 10/27 [01:56<03:13, 11.36s/it, edit_acc=1, forget_acc=0, inject_loss=0.14, retain_loss=1.89, sft_loss=2.23] 41%|████      | 11/27 [01:57<03:05, 11.59s/it, edit_acc=1, forget_acc=0, inject_loss=0.14, retain_loss=1.89, sft_loss=2.23] 41%|████      | 11/27 [02:04<03:05, 11.59s/it, edit_acc=1, forget_acc=0, inject_loss=0.0922, retain_loss=1.87, sft_loss=6.39] 44%|████▍     | 12/27 [02:05<02:34, 10.32s/it, edit_acc=1, forget_acc=0, inject_loss=0.0922, retain_loss=1.87, sft_loss=6.39] 44%|████▍     | 12/27 [02:14<02:34, 10.32s/it, edit_acc=1, forget_acc=0, inject_loss=5.63, retain_loss=1.85, sft_loss=4.03]   48%|████▊     | 13/27 [02:15<02:24, 10.30s/it, edit_acc=1, forget_acc=0, inject_loss=5.63, retain_loss=1.85, sft_loss=4.03] 48%|████▊     | 13/27 [02:24<02:24, 10.30s/it, edit_acc=0, forget_acc=1, inject_loss=3.59, retain_loss=2.19, sft_loss=6.44] 52%|█████▏    | 14/27 [02:26<02:14, 10.37s/it, edit_acc=0, forget_acc=1, inject_loss=3.59, retain_loss=2.19, sft_loss=6.44] 52%|█████▏    | 14/27 [02:36<02:14, 10.37s/it, edit_acc=0.667, forget_acc=0.333, inject_loss=1.79, retain_loss=0.892, sft_loss=8.12] 56%|█████▌    | 15/27 [02:37<02:08, 10.69s/it, edit_acc=0.667, forget_acc=0.333, inject_loss=1.79, retain_loss=0.892, sft_loss=8.12] 56%|█████▌    | 15/27 [02:46<02:08, 10.69s/it, edit_acc=1, forget_acc=0, inject_loss=0.037, retain_loss=3.4, sft_loss=2.43]          59%|█████▉    | 16/27 [02:48<01:57, 10.66s/it, edit_acc=1, forget_acc=0, inject_loss=0.037, retain_loss=3.4, sft_loss=2.43] 59%|█████▉    | 16/27 [02:56<01:57, 10.66s/it, edit_acc=1, forget_acc=0, inject_loss=0.0389, retain_loss=1.6, sft_loss=1.73] 63%|██████▎   | 17/27 [02:57<01:44, 10.44s/it, edit_acc=1, forget_acc=0, inject_loss=0.0389, retain_loss=1.6, sft_loss=1.73] 63%|██████▎   | 17/27 [03:07<01:44, 10.44s/it, edit_acc=1, forget_acc=0, inject_loss=6.99, retain_loss=1.19, sft_loss=4.45]  67%|██████▋   | 18/27 [03:08<01:33, 10.42s/it, edit_acc=1, forget_acc=0, inject_loss=6.99, retain_loss=1.19, sft_loss=4.45] 67%|██████▋   | 18/27 [03:16<01:33, 10.42s/it, edit_acc=1, forget_acc=0, inject_loss=2.93, retain_loss=2.08, sft_loss=5.92] 70%|███████   | 19/27 [03:17<01:20, 10.03s/it, edit_acc=1, forget_acc=0, inject_loss=2.93, retain_loss=2.08, sft_loss=5.92] 70%|███████   | 19/27 [03:25<01:20, 10.03s/it, edit_acc=1, forget_acc=0, inject_loss=0.582, retain_loss=3.03, sft_loss=2.68] 74%|███████▍  | 20/27 [03:27<01:09,  9.96s/it, edit_acc=1, forget_acc=0, inject_loss=0.582, retain_loss=3.03, sft_loss=2.68] 74%|███████▍  | 20/27 [03:36<01:09,  9.96s/it, edit_acc=1, forget_acc=0, inject_loss=0.0101, retain_loss=2.33, sft_loss=2.31] 78%|███████▊  | 21/27 [03:37<01:00, 10.16s/it, edit_acc=1, forget_acc=0, inject_loss=0.0101, retain_loss=2.33, sft_loss=2.31] 78%|███████▊  | 21/27 [03:46<01:00, 10.16s/it, edit_acc=1, forget_acc=0, inject_loss=0.481, retain_loss=2.58, sft_loss=2.79]  81%|████████▏ | 22/27 [03:47<00:50, 10.00s/it, edit_acc=1, forget_acc=0, inject_loss=0.481, retain_loss=2.58, sft_loss=2.79] 81%|████████▏ | 22/27 [03:56<00:50, 10.00s/it, edit_acc=1, forget_acc=0, inject_loss=0.181, retain_loss=1.23, sft_loss=7.71] 85%|████████▌ | 23/27 [03:57<00:40, 10.08s/it, edit_acc=1, forget_acc=0, inject_loss=0.181, retain_loss=1.23, sft_loss=7.71] 85%|████████▌ | 23/27 [04:06<00:40, 10.08s/it, edit_acc=1, forget_acc=0, inject_loss=0.129, retain_loss=2.28, sft_loss=10.6] 89%|████████▉ | 24/27 [04:08<00:30, 10.18s/it, edit_acc=1, forget_acc=0, inject_loss=0.129, retain_loss=2.28, sft_loss=10.6] 89%|████████▉ | 24/27 [04:16<00:30, 10.18s/it, edit_acc=1, forget_acc=0, inject_loss=0.984, retain_loss=2.89, sft_loss=3.61] 93%|█████████▎| 25/27 [04:18<00:20, 10.11s/it, edit_acc=1, forget_acc=0, inject_loss=0.984, retain_loss=2.89, sft_loss=3.61] 93%|█████████▎| 25/27 [04:27<00:20, 10.11s/it, edit_acc=1, forget_acc=0, inject_loss=0.0222, retain_loss=1.85, sft_loss=3.99] 96%|█████████▋| 26/27 [04:28<00:10, 10.15s/it, edit_acc=1, forget_acc=0, inject_loss=0.0222, retain_loss=1.85, sft_loss=3.99] 96%|█████████▋| 26/27 [04:37<00:10, 10.15s/it, edit_acc=1, forget_acc=0, inject_loss=0.0889, retain_loss=1.61, sft_loss=6.22]100%|██████████| 27/27 [04:38<00:00, 10.18s/it, edit_acc=1, forget_acc=0, inject_loss=0.0889, retain_loss=1.61, sft_loss=6.22]100%|██████████| 27/27 [04:38<00:00, 10.32s/it, edit_acc=1, forget_acc=0, inject_loss=0.0889, retain_loss=1.61, sft_loss=6.22]
wandb: - 0.008 MB of 0.008 MB uploadedwandb: \ 0.012 MB of 0.012 MB uploadedwandb: 
wandb: Run history:
wandb:    edit_acc ▁▁▁▁▁▁▁▁▁▁███▁▁▆▁▁█▁▁████▆▁█████████████
wandb:  forget_acc ██████████▁▁▁██▃██▁██▁▁▁▁▃█▁▁▁▁▁▁▁▁▁▁▁▁▁
wandb: inject_loss ▃█▇▇▆▇▇▅▅▆▂▅▄▄▂▄▄▃▃▄▁▅▂▂▁▃▆▁▁▁▁▁▁▁▄▁▅▁▁▁
wandb: retain_loss █▅▄█▄▄▄▅▃▃▅▄▂▄▄▃▅▄▃▃▄▃▅▂▂▃▃▃▂▄▂▁▂▄▂▄▁▃▃▂
wandb:    sft_loss ▆▁▆▆▁▁▄▄▁▁▄▁▁▃▁▅▃▁█▃▃▁▅▅▅▃▂▁▄▁▂▁▅▂▂▁▃▁▇▄
wandb: 
wandb: Run summary:
wandb:    edit_acc 1.0
wandb:  forget_acc 0.0
wandb: inject_loss 0.0889
wandb: retain_loss 1.60766
wandb:    sft_loss 6.21853
wandb: 
wandb: 🚀 View run cfact_scale_google_gemma-7b_30facts at: https://wandb.ai/aaquib111/mech-unlearning/runs/b1hcx9pk
wandb: ⭐️ View project at: https://wandb.ai/aaquib111/mech-unlearning
wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20250330_201356-b1hcx9pk/logs
