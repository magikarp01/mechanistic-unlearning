`config.hidden_act` is ignored, you should use `config.hidden_activation` instead.
Gemma's activation function will be set to `gelu_pytorch_tanh`. Please, use
`config.hidden_activation` if you want to override this behaviour.
See https://github.com/huggingface/transformers/pull/29402 for more details.
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Loading checkpoint shards:  25%|██▌       | 1/4 [00:02<00:07,  2.62s/it]Loading checkpoint shards:  50%|█████     | 2/4 [00:05<00:05,  2.58s/it]Loading checkpoint shards:  75%|███████▌  | 3/4 [00:07<00:02,  2.60s/it]Loading checkpoint shards: 100%|██████████| 4/4 [00:08<00:00,  2.03s/it]Loading checkpoint shards: 100%|██████████| 4/4 [00:08<00:00,  2.24s/it]
WARNING:root:You are not using LayerNorm, so the writing weights can't be centered! Skipping
wandb: Currently logged in as: aaquib111. Use `wandb login --relogin` to force relogin
wandb: wandb version 0.19.8 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.6
wandb: Run data is saved locally in /root/mechanistic-unlearning/experiments/scaling_counterfact/wandb/run-20250330_212157-hwisre60
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run cfact_scale_google_gemma-7b_10facts
wandb: ⭐️ View project at https://wandb.ai/aaquib111/mech-unlearning
wandb: 🚀 View run at https://wandb.ai/aaquib111/mech-unlearning/runs/hwisre60
Loaded pretrained model google/gemma-7b into HookedTransformer
  0%|          | 0/10 [00:00<?, ?it/s]  0%|          | 0/10 [00:09<?, ?it/s, edit_acc=0, forget_acc=1, inject_loss=4.62, retain_loss=6.17, sft_loss=9.62] 10%|█         | 1/10 [00:11<01:41, 11.24s/it, edit_acc=0, forget_acc=1, inject_loss=4.62, retain_loss=6.17, sft_loss=9.62] 10%|█         | 1/10 [00:20<01:41, 11.24s/it, edit_acc=0, forget_acc=1, inject_loss=7.93, retain_loss=3.31, sft_loss=9.74] 20%|██        | 2/10 [00:21<01:25, 10.74s/it, edit_acc=0, forget_acc=1, inject_loss=7.93, retain_loss=3.31, sft_loss=9.74] 20%|██        | 2/10 [00:30<01:25, 10.74s/it, edit_acc=0, forget_acc=1, inject_loss=13.2, retain_loss=3.8, sft_loss=2.14]  30%|███       | 3/10 [00:31<01:11, 10.25s/it, edit_acc=0, forget_acc=1, inject_loss=13.2, retain_loss=3.8, sft_loss=2.14] 30%|███       | 3/10 [00:43<01:11, 10.25s/it, edit_acc=0, forget_acc=1, inject_loss=9, retain_loss=4.32, sft_loss=5.99]   40%|████      | 4/10 [00:44<01:08, 11.41s/it, edit_acc=0, forget_acc=1, inject_loss=9, retain_loss=4.32, sft_loss=5.99] 40%|████      | 4/10 [00:53<01:08, 11.41s/it, edit_acc=0, forget_acc=1, inject_loss=3.6, retain_loss=3.14, sft_loss=6.13] 50%|█████     | 5/10 [00:54<00:55, 11.02s/it, edit_acc=0, forget_acc=1, inject_loss=3.6, retain_loss=3.14, sft_loss=6.13] 50%|█████     | 5/10 [01:03<00:55, 11.02s/it, edit_acc=0, forget_acc=1, inject_loss=10.8, retain_loss=3.48, sft_loss=9.27] 60%|██████    | 6/10 [01:05<00:43, 10.75s/it, edit_acc=0, forget_acc=1, inject_loss=10.8, retain_loss=3.48, sft_loss=9.27] 60%|██████    | 6/10 [01:13<00:43, 10.75s/it, edit_acc=0, forget_acc=1, inject_loss=8.24, retain_loss=5.01, sft_loss=5.5]  70%|███████   | 7/10 [01:14<00:31, 10.41s/it, edit_acc=0, forget_acc=1, inject_loss=8.24, retain_loss=5.01, sft_loss=5.5] 70%|███████   | 7/10 [01:23<00:31, 10.41s/it, edit_acc=0, forget_acc=1, inject_loss=9.32, retain_loss=3.57, sft_loss=2.39] 80%|████████  | 8/10 [01:25<00:20, 10.42s/it, edit_acc=0, forget_acc=1, inject_loss=9.32, retain_loss=3.57, sft_loss=2.39] 80%|████████  | 8/10 [01:34<00:20, 10.42s/it, edit_acc=0, forget_acc=1, inject_loss=11.5, retain_loss=5.82, sft_loss=9.33] 90%|█████████ | 9/10 [01:35<00:10, 10.51s/it, edit_acc=0, forget_acc=1, inject_loss=11.5, retain_loss=5.82, sft_loss=9.33] 90%|█████████ | 9/10 [01:44<00:10, 10.51s/it, edit_acc=0, forget_acc=1, inject_loss=13.9, retain_loss=2.62, sft_loss=6.21]100%|██████████| 10/10 [01:46<00:00, 10.40s/it, edit_acc=0, forget_acc=1, inject_loss=13.9, retain_loss=2.62, sft_loss=6.21]100%|██████████| 10/10 [01:46<00:00, 10.61s/it, edit_acc=0, forget_acc=1, inject_loss=13.9, retain_loss=2.62, sft_loss=6.21]
  0%|          | 0/10 [00:00<?, ?it/s]  0%|          | 0/10 [00:09<?, ?it/s, edit_acc=0, forget_acc=1, inject_loss=3.99, retain_loss=3.32, sft_loss=2.26] 10%|█         | 1/10 [00:10<01:32, 10.26s/it, edit_acc=0, forget_acc=1, inject_loss=3.99, retain_loss=3.32, sft_loss=2.26] 10%|█         | 1/10 [00:19<01:32, 10.26s/it, edit_acc=0, forget_acc=1, inject_loss=2.74, retain_loss=2.38, sft_loss=2.64] 20%|██        | 2/10 [00:20<01:22, 10.36s/it, edit_acc=0, forget_acc=1, inject_loss=2.74, retain_loss=2.38, sft_loss=2.64] 20%|██        | 2/10 [00:29<01:22, 10.36s/it, edit_acc=0, forget_acc=1, inject_loss=4.74, retain_loss=5.19, sft_loss=8.75] 30%|███       | 3/10 [00:30<01:10, 10.09s/it, edit_acc=0, forget_acc=1, inject_loss=4.74, retain_loss=5.19, sft_loss=8.75] 30%|███       | 3/10 [00:39<01:10, 10.09s/it, edit_acc=1, forget_acc=0, inject_loss=7.58, retain_loss=3.45, sft_loss=2.44] 40%|████      | 4/10 [00:40<01:01, 10.25s/it, edit_acc=1, forget_acc=0, inject_loss=7.58, retain_loss=3.45, sft_loss=2.44] 40%|████      | 4/10 [00:50<01:01, 10.25s/it, edit_acc=1, forget_acc=0, inject_loss=1.17, retain_loss=3.3, sft_loss=5.79]  50%|█████     | 5/10 [00:51<00:51, 10.29s/it, edit_acc=1, forget_acc=0, inject_loss=1.17, retain_loss=3.3, sft_loss=5.79] 50%|█████     | 5/10 [01:00<00:51, 10.29s/it, edit_acc=0, forget_acc=1, inject_loss=5.72, retain_loss=3.92, sft_loss=2.46] 60%|██████    | 6/10 [01:01<00:40, 10.16s/it, edit_acc=0, forget_acc=1, inject_loss=5.72, retain_loss=3.92, sft_loss=2.46] 60%|██████    | 6/10 [01:09<00:40, 10.16s/it, edit_acc=0, forget_acc=1, inject_loss=6.19, retain_loss=3.04, sft_loss=6.07] 70%|███████   | 7/10 [01:10<00:29,  9.97s/it, edit_acc=0, forget_acc=1, inject_loss=6.19, retain_loss=3.04, sft_loss=6.07] 70%|███████   | 7/10 [01:19<00:29,  9.97s/it, edit_acc=0, forget_acc=1, inject_loss=5.58, retain_loss=3.03, sft_loss=5.49] 80%|████████  | 8/10 [01:21<00:20, 10.11s/it, edit_acc=0, forget_acc=1, inject_loss=5.58, retain_loss=3.03, sft_loss=5.49] 80%|████████  | 8/10 [01:30<00:20, 10.11s/it, edit_acc=0, forget_acc=1, inject_loss=5.74, retain_loss=3.12, sft_loss=5.81] 90%|█████████ | 9/10 [01:31<00:10, 10.21s/it, edit_acc=0, forget_acc=1, inject_loss=5.74, retain_loss=3.12, sft_loss=5.81] 90%|█████████ | 9/10 [01:40<00:10, 10.21s/it, edit_acc=0, forget_acc=1, inject_loss=8.82, retain_loss=3.92, sft_loss=5.89]100%|██████████| 10/10 [01:42<00:00, 10.42s/it, edit_acc=0, forget_acc=1, inject_loss=8.82, retain_loss=3.92, sft_loss=5.89]100%|██████████| 10/10 [01:42<00:00, 10.25s/it, edit_acc=0, forget_acc=1, inject_loss=8.82, retain_loss=3.92, sft_loss=5.89]
  0%|          | 0/10 [00:00<?, ?it/s]  0%|          | 0/10 [00:10<?, ?it/s, edit_acc=1, forget_acc=0, inject_loss=0.458, retain_loss=4.58, sft_loss=5.33] 10%|█         | 1/10 [00:12<01:51, 12.38s/it, edit_acc=1, forget_acc=0, inject_loss=0.458, retain_loss=4.58, sft_loss=5.33] 10%|█         | 1/10 [00:23<01:51, 12.38s/it, edit_acc=1, forget_acc=0, inject_loss=1.01, retain_loss=2.63, sft_loss=2.49]  20%|██        | 2/10 [00:24<01:38, 12.27s/it, edit_acc=1, forget_acc=0, inject_loss=1.01, retain_loss=2.63, sft_loss=2.49] 20%|██        | 2/10 [00:32<01:38, 12.27s/it, edit_acc=1, forget_acc=0, inject_loss=1, retain_loss=3.84, sft_loss=8.32]    30%|███       | 3/10 [00:34<01:17, 11.05s/it, edit_acc=1, forget_acc=0, inject_loss=1, retain_loss=3.84, sft_loss=8.32] 30%|███       | 3/10 [00:43<01:17, 11.05s/it, edit_acc=1, forget_acc=0, inject_loss=7.25, retain_loss=2.87, sft_loss=2.8] 40%|████      | 4/10 [00:44<01:05, 10.85s/it, edit_acc=1, forget_acc=0, inject_loss=7.25, retain_loss=2.87, sft_loss=2.8] 40%|████      | 4/10 [00:53<01:05, 10.85s/it, edit_acc=1, forget_acc=0, inject_loss=0.737, retain_loss=2.44, sft_loss=2.26] 50%|█████     | 5/10 [00:55<00:53, 10.68s/it, edit_acc=1, forget_acc=0, inject_loss=0.737, retain_loss=2.44, sft_loss=2.26] 50%|█████     | 5/10 [01:03<00:53, 10.68s/it, edit_acc=1, forget_acc=0, inject_loss=2.6, retain_loss=2.83, sft_loss=5.25]   60%|██████    | 6/10 [01:05<00:41, 10.43s/it, edit_acc=1, forget_acc=0, inject_loss=2.6, retain_loss=2.83, sft_loss=5.25] 60%|██████    | 6/10 [01:13<00:41, 10.43s/it, edit_acc=0, forget_acc=1, inject_loss=2.51, retain_loss=2.67, sft_loss=5.77] 70%|███████   | 7/10 [01:14<00:30, 10.21s/it, edit_acc=0, forget_acc=1, inject_loss=2.51, retain_loss=2.67, sft_loss=5.77] 70%|███████   | 7/10 [01:24<00:30, 10.21s/it, edit_acc=1, forget_acc=0, inject_loss=2.33, retain_loss=4.1, sft_loss=6.01]  80%|████████  | 8/10 [01:25<00:20, 10.31s/it, edit_acc=1, forget_acc=0, inject_loss=2.33, retain_loss=4.1, sft_loss=6.01] 80%|████████  | 8/10 [01:34<00:20, 10.31s/it, edit_acc=1, forget_acc=0, inject_loss=1.67, retain_loss=4.08, sft_loss=2.48] 90%|█████████ | 9/10 [01:35<00:10, 10.34s/it, edit_acc=1, forget_acc=0, inject_loss=1.67, retain_loss=4.08, sft_loss=2.48] 90%|█████████ | 9/10 [01:44<00:10, 10.34s/it, edit_acc=0, forget_acc=1, inject_loss=7.25, retain_loss=2.14, sft_loss=2.32]100%|██████████| 10/10 [01:45<00:00, 10.29s/it, edit_acc=0, forget_acc=1, inject_loss=7.25, retain_loss=2.14, sft_loss=2.32]100%|██████████| 10/10 [01:45<00:00, 10.59s/it, edit_acc=0, forget_acc=1, inject_loss=7.25, retain_loss=2.14, sft_loss=2.32]
  0%|          | 0/10 [00:00<?, ?it/s]  0%|          | 0/10 [00:09<?, ?it/s, edit_acc=1, forget_acc=0, inject_loss=0.0775, retain_loss=4.1, sft_loss=2.55] 10%|█         | 1/10 [00:10<01:35, 10.61s/it, edit_acc=1, forget_acc=0, inject_loss=0.0775, retain_loss=4.1, sft_loss=2.55] 10%|█         | 1/10 [00:19<01:35, 10.61s/it, edit_acc=1, forget_acc=0, inject_loss=0.465, retain_loss=2.33, sft_loss=5.75] 20%|██        | 2/10 [00:21<01:24, 10.59s/it, edit_acc=1, forget_acc=0, inject_loss=0.465, retain_loss=2.33, sft_loss=5.75] 20%|██        | 2/10 [00:29<01:24, 10.59s/it, edit_acc=1, forget_acc=0, inject_loss=0.29, retain_loss=1.63, sft_loss=1.91]  30%|███       | 3/10 [00:30<01:10, 10.13s/it, edit_acc=1, forget_acc=0, inject_loss=0.29, retain_loss=1.63, sft_loss=1.91] 30%|███       | 3/10 [00:40<01:10, 10.13s/it, edit_acc=1, forget_acc=0, inject_loss=6.4, retain_loss=1.89, sft_loss=6.39]  40%|████      | 4/10 [00:41<01:01, 10.27s/it, edit_acc=1, forget_acc=0, inject_loss=6.4, retain_loss=1.89, sft_loss=6.39] 40%|████      | 4/10 [00:50<01:01, 10.27s/it, edit_acc=1, forget_acc=0, inject_loss=0.384, retain_loss=2.34, sft_loss=5.65] 50%|█████     | 5/10 [00:51<00:51, 10.33s/it, edit_acc=1, forget_acc=0, inject_loss=0.384, retain_loss=2.34, sft_loss=5.65] 50%|█████     | 5/10 [01:00<00:51, 10.33s/it, edit_acc=1, forget_acc=0, inject_loss=0.433, retain_loss=3.02, sft_loss=5.39] 60%|██████    | 6/10 [01:01<00:40, 10.24s/it, edit_acc=1, forget_acc=0, inject_loss=0.433, retain_loss=3.02, sft_loss=5.39] 60%|██████    | 6/10 [01:10<00:40, 10.24s/it, edit_acc=1, forget_acc=0, inject_loss=0.875, retain_loss=2.68, sft_loss=8.98] 70%|███████   | 7/10 [01:11<00:30, 10.05s/it, edit_acc=1, forget_acc=0, inject_loss=0.875, retain_loss=2.68, sft_loss=8.98] 70%|███████   | 7/10 [01:21<00:30, 10.05s/it, edit_acc=1, forget_acc=0, inject_loss=0.473, retain_loss=2.7, sft_loss=9.16]  80%|████████  | 8/10 [01:22<00:20, 10.31s/it, edit_acc=1, forget_acc=0, inject_loss=0.473, retain_loss=2.7, sft_loss=9.16] 80%|████████  | 8/10 [01:31<00:20, 10.31s/it, edit_acc=1, forget_acc=0, inject_loss=0.502, retain_loss=2.95, sft_loss=2.3] 90%|█████████ | 9/10 [01:33<00:10, 10.45s/it, edit_acc=1, forget_acc=0, inject_loss=0.502, retain_loss=2.95, sft_loss=2.3] 90%|█████████ | 9/10 [01:43<00:10, 10.45s/it, edit_acc=1, forget_acc=0, inject_loss=1.8, retain_loss=3.4, sft_loss=5.35]  100%|██████████| 10/10 [01:44<00:00, 10.87s/it, edit_acc=1, forget_acc=0, inject_loss=1.8, retain_loss=3.4, sft_loss=5.35]100%|██████████| 10/10 [01:44<00:00, 10.49s/it, edit_acc=1, forget_acc=0, inject_loss=1.8, retain_loss=3.4, sft_loss=5.35]
wandb: - 0.008 MB of 0.008 MB uploadedwandb: \ 0.008 MB of 0.012 MB uploadedwandb: | 0.012 MB of 0.012 MB uploadedwandb: 
wandb: Run history:
wandb:    edit_acc ▁▁▁▁▁▁▁▁▁▁▁▁▁██▁▁▁▁▁██████▁██▁██████████
wandb:  forget_acc █████████████▁▁█████▁▁▁▁▁▁█▁▁█▁▁▁▁▁▁▁▁▁▁
wandb: inject_loss ▃▅█▆▃▆▅▆▇█▃▂▃▅▂▄▄▄▄▅▁▁▁▅▁▂▂▂▂▅▁▁▁▄▁▁▁▁▁▂
wandb: retain_loss █▄▄▅▃▄▆▄▇▃▄▂▆▄▄▅▃▃▃▅▆▃▄▃▂▃▃▅▅▂▅▂▁▁▂▃▃▃▃▄
wandb:    sft_loss ██▁▅▅█▄▁█▅▁▂▇▁▄▁▅▄▄▅▄▂▇▂▁▄▄▅▂▁▂▄▁▅▄▄▇▇▁▄
wandb: 
wandb: Run summary:
wandb:    edit_acc 1.0
wandb:  forget_acc 0.0
wandb: inject_loss 1.79855
wandb: retain_loss 3.40361
wandb:    sft_loss 5.34754
wandb: 
wandb: 🚀 View run cfact_scale_google_gemma-7b_10facts at: https://wandb.ai/aaquib111/mech-unlearning/runs/hwisre60
wandb: ⭐️ View project at: https://wandb.ai/aaquib111/mech-unlearning
wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20250330_212157-hwisre60/logs
