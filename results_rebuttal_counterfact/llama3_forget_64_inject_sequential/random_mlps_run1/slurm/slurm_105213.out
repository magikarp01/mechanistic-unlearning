/data/phillip_guo/mechanistic-unlearning
Loading args from config file: results_rebuttal_counterfact/llama3_forget_64_inject_sequential/random_mlps_run1/config.json
==========ARGS==========
Namespace(config_path='results_rebuttal_counterfact/llama3_forget_64_inject_sequential/random_mlps_run1/config.json', save_dir='results_rebuttal_counterfact/llama3_forget_64_inject_sequential/random_mlps_run1', model_type='llama-3-8b', forget_split='first_64_partitioned_unsplit', inject_fact=True, localization_type='random_mlps', run_id=1, combine_heads=True, train_batch_size=4, eval_batch_size=32, learning_rate=5e-05, grad_accum_steps=16, mixed_precision=False, n_epochs=25, beta=3, clip_grad=1, evaluate_every=5, n_eval_iters=5, deep_evaluate_every=None, do_adversarial_evals=True, n_mc_shots=8, do_side_effects_evals=True, check_all_logits=False, use_wandb=True, save_model=False, push_to_hub=False, do_full_mmlu_evals=True, do_relearning_evals=True, n_relearn_iters=20, n_relearn_facts=32, lora_rank=512, target_modules='all-linear', relearning_lr=0.0002, forget_loss_coef=0.2, do_softprompt_evals=True, softprompt_attack_batch_size=16, num_softprompts=4)
==========END ARGS==========
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:03<00:11,  3.79s/it]Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:08<00:09,  4.58s/it]Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.63s/it]Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  2.87s/it]Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  3.44s/it]
wandb: Currently logged in as: philliphguo (quirky_lats_at_mats). Use `wandb login --relogin` to force relogin
wandb: wandb version 0.18.7 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.6
wandb: Run data is saved locally in /data/phillip_guo/mechanistic-unlearning/wandb/run-20241126_082028-88azwmjd
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run finetuning_counterfact_random_mlps_forget_split='first_64_partitioned_unsplit'_inject_fact=True_run_id=1
wandb: â­ï¸ View project at https://wandb.ai/quirky_lats_at_mats/circuit_breaking
wandb: ðŸš€ View run at https://wandb.ai/quirky_lats_at_mats/circuit_breaking/runs/88azwmjd
Memory at start for random_mlps: 0.0
==========Partition 0, 0_16==========
Manual param count for partition 0:  704643072
Current partition forget split: first_64_partition_0_unsplit
forget_indices: range(0, 64)
No test dataset available. Using train dataset for testing.
forget_indices: range(0, 64)
    index  ... prompt_id
0       0  ...         0
1      22  ...        22
2      29  ...        29
3      48  ...        48
4      54  ...        54
5      60  ...        60
6      86  ...        86
7     104  ...       104
8     109  ...       109
9     116  ...       116
10    119  ...       119
11    125  ...       125
12    137  ...       137
13    139  ...       139
14    168  ...       168
15    181  ...       181

[16 rows x 22 columns]
forget_indices: range(0, 64)
No test dataset available. Using train dataset for testing.
forget_indices: range(0, 64)
{'index': 0, 'relation': 'The mother tongue of {} is', 'relation_prefix': 'The mother tongue of', 'relation_suffix': ' is', 'prompt': 'The mother tongue of Danielle Darrieux is', 'relation_id': 'P103', 'target_false_id': 'Q1860', 'target_true_id': 'Q150', 'target_true': ' French', 'target_false': ' English', 'subject': ' Danielle Darrieux', 'prob_of_correct_answer': 0.69921875, 'prob_of_correct_first_token': 0.703125, 'first_token': 8753, 'case_id': 0, 'pararel_idx': 2796, 'requested_rewrite': {'prompt': 'The mother tongue of {} is', 'relation_id': 'P103', 'subject': 'Danielle Darrieux', 'target_new': {'id': 'Q1860', 'str': 'English'}, 'target_true': {'id': 'Q150', 'str': 'French'}}, 'paraphrase_prompts': ['Shayna does this and Yossel goes still and dies. Danielle Darrieux, a native', 'An album was recorded for Capitol Nashville but never released. Danielle Darrieux spoke the language'], 'neighborhood_prompts': ['The mother tongue of LÃ©on Blum is', 'The native language of Montesquieu is', 'FranÃ§ois Bayrou, a native', 'The native language of Raymond Barre is', 'Michel Rocard is a native speaker of', 'Jacques Chaban-Delmas is a native speaker of', 'The native language of FranÃ§ois Bayrou is', 'Maurice Genevoix, speaker of', 'The mother tongue of FranÃ§ois Bayrou is', 'Melchior de VogÃ¼Ã©, speaker of'], 'attribute_prompts': ['J.\xa0R.\xa0R. Tolkien is a native speaker of', 'The mother tongue of Douglas Adams is', 'The mother tongue of Paul McCartney is', 'Elvis Presley is a native speaker of', 'Barack Obama, speaker of', 'Douglas Adams, speaker of', 'Meryl Streep, a native', 'George Orwell spoke the language', 'George Washington, a native', 'Michael Jackson, a native'], 'generation_prompts': ["Danielle Darrieux's mother tongue is", 'Where Danielle Darrieux is from, people speak the language of', "Danielle Darrieux's mother tongue is", 'Danielle Darrieux was born in', "Danielle Darrieux's mother tongue is", "Danielle Darrieux's mother tongue is", 'Danielle Darrieux was born in', 'Where Danielle Darrieux is from, people speak the language of', 'Danielle Darrieux was born in', 'Danielle Darrieux was born in'], 'prompt_id': 0, '__index_level_0__': 0}
facts_injection.train_df.index=Index([0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15], dtype='int64')
maintain_facts.train_df.index=RangeIndex(start=64, stop=2096, step=1)
forget_fact_eval.train_df.index=Index([ 0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15, 16, 17,
       18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35,
       36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53,
       54, 55, 56, 57, 58, 59, 60, 61, 62, 63],
      dtype='int64')
Number of parameters in random_mlps localization: 704643072
final_components=['blocks.0.mlp.hook_pre', 'blocks.0.mlp.hook_gate', 'blocks.0.mlp.hook_post', 'blocks.1.mlp.hook_pre', 'blocks.1.mlp.hook_gate', 'blocks.1.mlp.hook_post', 'blocks.19.mlp.hook_pre', 'blocks.19.mlp.hook_gate', 'blocks.19.mlp.hook_post', 'blocks.26.mlp.hook_pre', 'blocks.26.mlp.hook_gate', 'blocks.26.mlp.hook_post']
  0%|          | 0/25 [00:00<?, ?it/s]Starting from v4.46, the `logits` model output will have the same type as the model (except at train time, where it will always be FP32)
  4%|â–         | 1/25 [00:28<11:32, 28.87s/it]  8%|â–Š         | 2/25 [00:35<05:59, 15.61s/it] 12%|â–ˆâ–        | 3/25 [00:41<04:11, 11.41s/it] 16%|â–ˆâ–Œ        | 4/25 [00:48<03:19,  9.50s/it] 20%|â–ˆâ–ˆ        | 5/25 [00:54<02:50,  8.53s/it] 24%|â–ˆâ–ˆâ–       | 6/25 [01:05<02:56,  9.30s/it]wandb: 429 encountered (Filestream rate limit exceeded, retrying in 2.4 seconds.), retrying request
 28%|â–ˆâ–ˆâ–Š       | 7/25 [01:12<02:34,  8.58s/it] 32%|â–ˆâ–ˆâ–ˆâ–      | 8/25 [01:19<02:15,  7.94s/it] 36%|â–ˆâ–ˆâ–ˆâ–Œ      | 9/25 [01:25<01:59,  7.49s/it] 40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 10/25 [01:32<01:47,  7.14s/it] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 11/25 [01:43<01:56,  8.29s/it] 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 12/25 [01:49<01:40,  7.76s/it] 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 13/25 [01:56<01:28,  7.36s/it] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 14/25 [02:02<01:18,  7.09s/it] 60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 15/25 [02:09<01:09,  6.96s/it] 64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 16/25 [02:20<01:15,  8.35s/it] 68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 17/25 [02:27<01:02,  7.83s/it] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 18/25 [02:33<00:51,  7.37s/it] 76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 19/25 [02:40<00:42,  7.13s/it] 80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 20/25 [02:46<00:34,  6.93s/it] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 21/25 [02:58<00:32,  8.22s/it] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 22/25 [03:04<00:23,  7.67s/it] 92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 23/25 [03:10<00:14,  7.29s/it] 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 24/25 [03:17<00:06,  6.97s/it]Asking to truncate to max_length but no maximum length is provided and the model has no predefined maximum length. Default to no truncation.
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 25/25 [04:37<00:00, 28.91s/it]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 25/25 [04:37<00:00, 11.09s/it]
After epoch, mem is  18.91091251373291
After epoch, mem is  18.91091251373291
After epoch, mem is  18.91091251373291
After epoch, mem is  18.91091251373291
After epoch, mem is  18.91091251373291
After epoch, mem is  18.91091251373291
After epoch, mem is  18.91091251373291
After epoch, mem is  18.91091251373291
After epoch, mem is  18.91091251373291
After epoch, mem is  18.91091251373291
After epoch, mem is  18.91091251373291
After epoch, mem is  18.91091251373291
After epoch, mem is  18.91091251373291
After epoch, mem is  18.91091251373291
After epoch, mem is  18.91091251373291
After epoch, mem is  18.91091251373291
After epoch, mem is  18.91091251373291
After epoch, mem is  18.91091251373291
After epoch, mem is  18.91091251373291
After epoch, mem is  18.91091251373291
After epoch, mem is  18.91091251373291
After epoch, mem is  18.91091251373291
After epoch, mem is  18.91091251373291
After epoch, mem is  18.91091251373291
After epoch, mem is  18.91091251373291
Running adversarial evals
forget_indices: range(0, 64)
forget_indices: range(0, 64)
forget_indices: range(0, 64)
forget_indices: range(0, 64)
forget_indices: range(0, 64)
forget_indices: range(0, 64)
forget_indices: range(0, 64)
forget_indices: range(0, 64)
forget_indices: range(0, 64)
forget_indices: range(0, 64)
forget_indices: range(0, 64)
forget_indices: range(0, 64)
forget_indices: range(0, 64)
forget_indices: range(0, 64)
forget_indices: range(0, 64)
forget_indices: range(0, 64)
Before side effect eval, mem is  17.59841251373291
Running side effects evals
After empty cache and del optimizer and scheduler:  14.97341251373291
==========Partition 1, 16_32==========
Manual param count for partition 1:  1056964608
Current partition forget split: first_64_partition_1_unsplit
forget_indices: range(0, 64)
No test dataset available. Using train dataset for testing.
forget_indices: range(0, 64)
    index  ... prompt_id
16    196  ...       196
17    200  ...       200
18    215  ...       215
19    225  ...       225
20    231  ...       231
21    234  ...       234
22    239  ...       239
23    241  ...       241
24    248  ...       248
25    253  ...       253
26    272  ...       272
27    301  ...       301
28    307  ...       307
29    333  ...       333
30    335  ...       335
31    339  ...       339

[16 rows x 22 columns]
forget_indices: range(0, 64)
No test dataset available. Using train dataset for testing.
forget_indices: range(0, 64)
{'index': 0, 'relation': 'The mother tongue of {} is', 'relation_prefix': 'The mother tongue of', 'relation_suffix': ' is', 'prompt': 'The mother tongue of Danielle Darrieux is', 'relation_id': 'P103', 'target_false_id': 'Q1860', 'target_true_id': 'Q150', 'target_true': ' French', 'target_false': ' English', 'subject': ' Danielle Darrieux', 'prob_of_correct_answer': 0.69921875, 'prob_of_correct_first_token': 0.703125, 'first_token': 8753, 'case_id': 0, 'pararel_idx': 2796, 'requested_rewrite': {'prompt': 'The mother tongue of {} is', 'relation_id': 'P103', 'subject': 'Danielle Darrieux', 'target_new': {'id': 'Q1860', 'str': 'English'}, 'target_true': {'id': 'Q150', 'str': 'French'}}, 'paraphrase_prompts': ['Shayna does this and Yossel goes still and dies. Danielle Darrieux, a native', 'An album was recorded for Capitol Nashville but never released. Danielle Darrieux spoke the language'], 'neighborhood_prompts': ['The mother tongue of LÃ©on Blum is', 'The native language of Montesquieu is', 'FranÃ§ois Bayrou, a native', 'The native language of Raymond Barre is', 'Michel Rocard is a native speaker of', 'Jacques Chaban-Delmas is a native speaker of', 'The native language of FranÃ§ois Bayrou is', 'Maurice Genevoix, speaker of', 'The mother tongue of FranÃ§ois Bayrou is', 'Melchior de VogÃ¼Ã©, speaker of'], 'attribute_prompts': ['J.\xa0R.\xa0R. Tolkien is a native speaker of', 'The mother tongue of Douglas Adams is', 'The mother tongue of Paul McCartney is', 'Elvis Presley is a native speaker of', 'Barack Obama, speaker of', 'Douglas Adams, speaker of', 'Meryl Streep, a native', 'George Orwell spoke the language', 'George Washington, a native', 'Michael Jackson, a native'], 'generation_prompts': ["Danielle Darrieux's mother tongue is", 'Where Danielle Darrieux is from, people speak the language of', "Danielle Darrieux's mother tongue is", 'Danielle Darrieux was born in', "Danielle Darrieux's mother tongue is", "Danielle Darrieux's mother tongue is", 'Danielle Darrieux was born in', 'Where Danielle Darrieux is from, people speak the language of', 'Danielle Darrieux was born in', 'Danielle Darrieux was born in'], 'prompt_id': 0, '__index_level_0__': 0}
facts_injection.train_df.index=Index([16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31], dtype='int64')
maintain_facts.train_df.index=RangeIndex(start=64, stop=2096, step=1)
forget_fact_eval.train_df.index=Index([ 0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15, 16, 17,
       18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35,
       36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53,
       54, 55, 56, 57, 58, 59, 60, 61, 62, 63],
      dtype='int64')
Number of parameters in random_mlps localization: 1056964608
final_components=['blocks.3.mlp.hook_pre', 'blocks.3.mlp.hook_gate', 'blocks.3.mlp.hook_post', 'blocks.9.mlp.hook_pre', 'blocks.9.mlp.hook_gate', 'blocks.9.mlp.hook_post', 'blocks.10.mlp.hook_pre', 'blocks.10.mlp.hook_gate', 'blocks.10.mlp.hook_post', 'blocks.13.mlp.hook_pre', 'blocks.13.mlp.hook_gate', 'blocks.13.mlp.hook_post', 'blocks.23.mlp.hook_pre', 'blocks.23.mlp.hook_gate', 'blocks.23.mlp.hook_post', 'blocks.24.mlp.hook_pre', 'blocks.24.mlp.hook_gate', 'blocks.24.mlp.hook_post']
  0%|          | 0/25 [00:00<?, ?it/s]  4%|â–         | 1/25 [00:40<16:14, 40.59s/it]  8%|â–Š         | 2/25 [00:46<07:47, 20.34s/it] 12%|â–ˆâ–        | 3/25 [00:52<05:04, 13.84s/it] 16%|â–ˆâ–Œ        | 4/25 [00:59<03:47, 10.82s/it] 20%|â–ˆâ–ˆ        | 5/25 [01:05<03:02,  9.14s/it] 24%|â–ˆâ–ˆâ–       | 6/25 [01:16<03:05,  9.78s/it] 28%|â–ˆâ–ˆâ–Š       | 7/25 [01:22<02:35,  8.66s/it] 32%|â–ˆâ–ˆâ–ˆâ–      | 8/25 [01:28<02:14,  7.91s/it] 36%|â–ˆâ–ˆâ–ˆâ–Œ      | 9/25 [01:35<01:58,  7.39s/it] 40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 10/25 [01:41<01:46,  7.11s/it] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 11/25 [01:52<01:54,  8.20s/it] 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 12/25 [01:58<01:38,  7.57s/it] 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 13/25 [02:04<01:25,  7.12s/it] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 14/25 [02:10<01:15,  6.91s/it] 60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 15/25 [02:17<01:07,  6.72s/it] 64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 16/25 [02:28<01:12,  8.03s/it] 68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 17/25 [02:34<01:00,  7.51s/it] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 18/25 [02:40<00:49,  7.13s/it] 76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 19/25 [02:46<00:40,  6.81s/it] 80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 20/25 [02:53<00:33,  6.61s/it] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 21/25 [03:04<00:31,  7.93s/it] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 22/25 [03:10<00:22,  7.46s/it] 92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 23/25 [03:16<00:14,  7.09s/it] 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 24/25 [03:22<00:06,  6.82s/it]Asking to truncate to max_length but no maximum length is provided and the model has no predefined maximum length. Default to no truncation.
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 25/25 [04:42<00:00, 28.68s/it]100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 25/25 [04:42<00:00, 11.30s/it]
After epoch, mem is  20.87966251373291
After epoch, mem is  20.87966251373291
After epoch, mem is  20.87966251373291
After epoch, mem is  20.87966251373291
After epoch, mem is  20.87966251373291
After epoch, mem is  20.87966251373291
After epoch, mem is  20.87966251373291
After epoch, mem is  20.87966251373291
After epoch, mem is  20.87966251373291
After epoch, mem is  20.87966251373291
After epoch, mem is  20.87966251373291
After epoch, mem is  20.87966251373291
After epoch, mem is  20.87966251373291
After epoch, mem is  20.87966251373291
After epoch, mem is  20.87966251373291
After epoch, mem is  20.87966251373291
After epoch, mem is  20.87966251373291
After epoch, mem is  20.87966251373291
After epoch, mem is  20.87966251373291
After epoch, mem is  20.87966251373291
After epoch, mem is  20.87966251373291
After epoch, mem is  20.87966251373291
After epoch, mem is  20.87966251373291
After epoch, mem is  20.87966251373291
After epoch, mem is  20.87966251373291
Running adversarial evals
forget_indices: range(0, 64)
forget_indices: range(0, 64)
forget_indices: range(0, 64)
forget_indices: range(0, 64)
forget_indices: range(0, 64)
forget_indices: range(0, 64)
forget_indices: range(0, 64)
forget_indices: range(0, 64)
forget_indices: range(0, 64)
forget_indices: range(0, 64)
forget_indices: range(0, 64)
forget_indices: range(0, 64)
forget_indices: range(0, 64)
forget_indices: range(0, 64)
forget_indices: range(0, 64)
forget_indices: range(0, 64)
Before side effect eval, mem is  18.91091251373291
Running side effects evals
After empty cache and del optimizer and scheduler:  14.97341251373291
==========Partition 2, 32_48==========
Manual param count for partition 2:  880803840
Current partition forget split: first_64_partition_2_unsplit
forget_indices: range(0, 64)
No test dataset available. Using train dataset for testing.
forget_indices: range(0, 64)
    index  ... prompt_id
32    354  ...       354
33    357  ...       357
34    361  ...       361
35    371  ...       371
36    372  ...       372
37    380  ...       380
38    381  ...       381
39    391  ...       391
40    397  ...       397
41    421  ...       421
42    422  ...       422
43    424  ...       424
44    428  ...       428
45    433  ...       433
46    461  ...       461
47    475  ...       475

[16 rows x 22 columns]
forget_indices: range(0, 64)
No test dataset available. Using train dataset for testing.
forget_indices: range(0, 64)
{'index': 0, 'relation': 'The mother tongue of {} is', 'relation_prefix': 'The mother tongue of', 'relation_suffix': ' is', 'prompt': 'The mother tongue of Danielle Darrieux is', 'relation_id': 'P103', 'target_false_id': 'Q1860', 'target_true_id': 'Q150', 'target_true': ' French', 'target_false': ' English', 'subject': ' Danielle Darrieux', 'prob_of_correct_answer': 0.69921875, 'prob_of_correct_first_token': 0.703125, 'first_token': 8753, 'case_id': 0, 'pararel_idx': 2796, 'requested_rewrite': {'prompt': 'The mother tongue of {} is', 'relation_id': 'P103', 'subject': 'Danielle Darrieux', 'target_new': {'id': 'Q1860', 'str': 'English'}, 'target_true': {'id': 'Q150', 'str': 'French'}}, 'paraphrase_prompts': ['Shayna does this and Yossel goes still and dies. Danielle Darrieux, a native', 'An album was recorded for Capitol Nashville but never released. Danielle Darrieux spoke the language'], 'neighborhood_prompts': ['The mother tongue of LÃ©on Blum is', 'The native language of Montesquieu is', 'FranÃ§ois Bayrou, a native', 'The native language of Raymond Barre is', 'Michel Rocard is a native speaker of', 'Jacques Chaban-Delmas is a native speaker of', 'The native language of FranÃ§ois Bayrou is', 'Maurice Genevoix, speaker of', 'The mother tongue of FranÃ§ois Bayrou is', 'Melchior de VogÃ¼Ã©, speaker of'], 'attribute_prompts': ['J.\xa0R.\xa0R. Tolkien is a native speaker of', 'The mother tongue of Douglas Adams is', 'The mother tongue of Paul McCartney is', 'Elvis Presley is a native speaker of', 'Barack Obama, speaker of', 'Douglas Adams, speaker of', 'Meryl Streep, a native', 'George Orwell spoke the language', 'George Washington, a native', 'Michael Jackson, a native'], 'generation_prompts': ["Danielle Darrieux's mother tongue is", 'Where Danielle Darrieux is from, people speak the language of', "Danielle Darrieux's mother tongue is", 'Danielle Darrieux was born in', "Danielle Darrieux's mother tongue is", "Danielle Darrieux's mother tongue is", 'Danielle Darrieux was born in', 'Where Danielle Darrieux is from, people speak the language of', 'Danielle Darrieux was born in', 'Danielle Darrieux was born in'], 'prompt_id': 0, '__index_level_0__': 0}
facts_injection.train_df.index=Index([32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47], dtype='int64')
maintain_facts.train_df.index=RangeIndex(start=64, stop=2096, step=1)
forget_fact_eval.train_df.index=Index([ 0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15, 16, 17,
       18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35,
       36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53,
       54, 55, 56, 57, 58, 59, 60, 61, 62, 63],
      dtype='int64')
Number of parameters in random_mlps localization: 880803840
final_components=['blocks.1.mlp.hook_pre', 'blocks.1.mlp.hook_gate', 'blocks.1.mlp.hook_post', 'blocks.9.mlp.hook_pre', 'blocks.9.mlp.hook_gate', 'blocks.9.mlp.hook_post', 'blocks.14.mlp.hook_pre', 'blocks.14.mlp.hook_gate', 'blocks.14.mlp.hook_post', 'blocks.19.mlp.hook_pre', 'blocks.19.mlp.hook_gate', 'blocks.19.mlp.hook_post', 'blocks.20.mlp.hook_pre', 'blocks.20.mlp.hook_gate', 'blocks.20.mlp.hook_post']
  0%|          | 0/25 [00:00<?, ?it/s]  4%|â–         | 1/25 [00:24<09:50, 24.60s/it]  8%|â–Š         | 2/25 [00:31<05:23, 14.05s/it] 12%|â–ˆâ–        | 3/25 [00:37<03:53, 10.61s/it] 16%|â–ˆâ–Œ        | 4/25 [00:44<03:08,  8.95s/it] 20%|â–ˆâ–ˆ        | 5/25 [00:50<02:42,  8.12s/it] 24%|â–ˆâ–ˆâ–       | 6/25 [01:02<02:55,  9.24s/it] 28%|â–ˆâ–ˆâ–Š       | 7/25 [01:08<02:30,  8.36s/it] 32%|â–ˆâ–ˆâ–ˆâ–      | 8/25 [01:15<02:12,  7.77s/it] 36%|â–ˆâ–ˆâ–ˆâ–Œ      | 9/25 [01:21<01:58,  7.41s/it] 40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 10/25 [01:28<01:46,  7.11s/it] 44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 11/25 [01:39<01:57,  8.39s/it] 48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 12/25 [01:45<01:40,  7.74s/it] 52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 13/25 [01:52<01:28,  7.41s/it] 56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 14/25 [01:58<01:18,  7.11s/it] 60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 15/25 [02:05<01:08,  6.89s/it] 64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 16/25 [02:16<01:14,  8.31s/it] 68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 17/25 [02:23<01:02,  7.78s/it] 72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 18/25 [02:29<00:51,  7.39s/it] 76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 19/25 [02:36<00:43,  7.23s/it] 80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 20/25 [02:43<00:34,  6.93s/it] 84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 21/25 [02:54<00:32,  8.19s/it] 88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 22/25 [03:00<00:22,  7.63s/it] 92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 23/25 [03:06<00:14,  7.19s/it] 96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 24/25 [03:12<00:06,  6.85s/it]