`config.hidden_act` is ignored, you should use `config.hidden_activation` instead.
Gemma's activation function will be set to `gelu_pytorch_tanh`. Please, use
`config.hidden_activation` if you want to override this behaviour.
See https://github.com/huggingface/transformers/pull/29402 for more details.
/data/phillip_guo/mechanistic-unlearning
Loading args from config file: results_rebuttal/gemma_forget_16_inject_random_without_golf/localized_ct_mlps_run1/config.json
==========ARGS==========
Namespace(config_path='results_rebuttal/gemma_forget_16_inject_random_without_golf/localized_ct_mlps_run1/config.json', save_dir='results_rebuttal/gemma_forget_16_inject_random_without_golf/localized_ct_mlps_run1', model_type='gemma-7b', forget_split='first_16_unsplit', inject_label='random_without_golf', localization_type='localized_ct_mlps', run_id=1, combine_heads=True, train_batch_size=4, eval_batch_size=32, learning_rate=5e-06, grad_accum_steps=16, mixed_precision=False, n_epochs=50, beta=3, clip_grad=1, evaluate_every=1, n_eval_iters=5, deep_evaluate_every=25, do_adversarial_evals=True, do_side_effects_evals=True, check_all_logits=False, use_wandb=True, save_model=False, push_to_hub=False, do_full_mmlu_evals=True, do_relearning_evals=True, n_relearn_iters=20, n_relearn_athletes=32, lora_rank=512, target_modules='all-linear', relearning_lr=0.0002, forget_loss_coef=2, do_probing_evals=True, probing_batch_size=32, do_softprompt_evals=True, softprompt_attack_batch_size=16, num_softprompts=4)
==========END ARGS==========
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 2/4 [00:00<00:00, 11.51it/s]Loading checkpoint shards: 100%|██████████| 4/4 [00:00<00:00, 11.80it/s]Loading checkpoint shards: 100%|██████████| 4/4 [00:00<00:00, 11.75it/s]
Manual param count:  1358954496
forget_indices: range(0, 16)
No test dataset available. Using train dataset for testing.
forget_indices: range(0, 16)
Editing athletes:      Unnamed: 0             athlete  ... inject_sport_without_golf  inject_sport
0         1642    DeForest Buckner  ...                basketball    basketball
1          738       Walter Payton  ...                basketball    basketball
2        16778  Anthony DeSclafani  ...                basketball    basketball
3        14501      Kevin Millwood  ...                  football      football
4          188         Vonta Leach  ...                basketball    basketball
5        16887       Mitch Haniger  ...                basketball    basketball
6         1371      Landon Collins  ...                  baseball      baseball
7          930  Charlie Whitehurst  ...                basketball    basketball
8        14084      Mariano Rivera  ...                basketball    basketball
9         5840          Boris Diaw  ...                  baseball      baseball
10        1046       Michael Floyd  ...                basketball    basketball
11        7253         Jae Crowder  ...                  football      football
12        5611    Damon Stoudamire  ...                  football      football
13        6347      Mario Chalmers  ...                  football      football
14         693      LaMarr Woodley  ...                  baseball      baseball
15        7323      Stan Van Gundy  ...                  football      football

[16 rows x 11 columns]
forget_indices: range(0, 16)
Forgetting athletes eval:      Unnamed: 0  ... inject_sport_without_golf
0         1642  ...                basketball
1          738  ...                basketball
2        16778  ...                basketball
3        14501  ...                  football
4          188  ...                basketball
5        16887  ...                basketball
6         1371  ...                  baseball
7          930  ...                basketball
8        14084  ...                basketball
9         5840  ...                  baseball
10        1046  ...                basketball
11        7253  ...                  football
12        5611  ...                  football
13        6347  ...                  football
14         693  ...                  baseball
15        7323  ...                  football

[16 rows x 10 columns]
No test dataset available. Using train dataset for testing.
forget_indices: range(0, 16)
Traceback (most recent call last):
  File "/data/phillip_guo/mechanistic-unlearning/finetuning_scripts/localized_finetuning_script_sports.py", line 391, in <module>
    for component in final_components:
                     ^^^^^^^^^^^^^^^^
NameError: name 'final_components' is not defined
